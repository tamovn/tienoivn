(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=e(i);fetch(i.href,l)}})();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Hn,$n;function bn(){return{geminiUrl:Hn,vertexUrl:$n}}function Jn(o,t,e){var n,i,l;if(!(!((n=o.httpOptions)===null||n===void 0)&&n.baseUrl)){const a=bn();return o.vertexai?(i=a.vertexUrl)!==null&&i!==void 0?i:t:(l=a.geminiUrl)!==null&&l!==void 0?l:e}return o.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ne{}function T(o,t){const e=/\{([^}]+)\}/g;return o.replace(e,(n,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const l=t[i];return l!=null?String(l):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function r(o,t,e){for(let l=0;l<t.length-1;l++){const a=t[l];if(a.endsWith("[]")){const c=a.slice(0,-2);if(!(c in o))if(Array.isArray(e))o[c]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(o[c])){const d=o[c];if(Array.isArray(e))for(let u=0;u<d.length;u++){const f=d[u];r(f,t.slice(l+1),e[u])}else for(const u of d)r(u,t.slice(l+1),e)}return}else if(a.endsWith("[0]")){const c=a.slice(0,-3);c in o||(o[c]=[{}]);const d=o[c];r(d[0],t.slice(l+1),e);return}(!o[a]||typeof o[a]!="object")&&(o[a]={}),o=o[a]}const n=t[t.length-1],i=o[n];if(i!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===i)return;if(typeof i=="object"&&typeof e=="object"&&i!==null&&e!==null)Object.assign(i,e);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else o[n]=e}function s(o,t){try{if(t.length===1&&t[0]==="_self")return o;for(let e=0;e<t.length;e++){if(typeof o!="object"||o===null)return;const n=t[e];if(n.endsWith("[]")){const i=n.slice(0,-2);if(i in o){const l=o[i];return Array.isArray(l)?l.map(a=>s(a,t.slice(e+1))):void 0}else return}else o=o[n]}return o}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function A(o,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function gn(o,t){const e=A(o,t);return e?e.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:e.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${e}`:e:""}function yn(o,t){return Array.isArray(t)?t.map(e=>fe(o,e)):[fe(o,t)]}function fe(o,t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Yn(o,t){const e=fe(o,t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Kn(o,t){const e=fe(o,t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Ze(o,t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Cn(o,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Ze(o,e)):[Ze(o,t)]}function Ue(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function je(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function et(o){return o!=null&&typeof o=="object"&&"functionResponse"in o}function N(o,t){if(t==null)throw new Error("ContentUnion is required");return Ue(t)?t:{role:"user",parts:Cn(o,t)}}function Tn(o,t){if(!t)return[];if(o.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const n=N(o,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(o.isVertexAI()){const e=N(o,t);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>N(o,e)):[N(o,t)]}function $(o,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(je(t)||et(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[N(o,t)]}const e=[],n=[],i=Ue(t[0]);for(const l of t){const a=Ue(l);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(l);else{if(je(l)||et(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(l)}}return i||e.push({role:"user",parts:Cn(o,n)}),e}function vn(o,t){return t}function En(o,t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Te(o,t){return t}function ve(o,t){if(!Array.isArray(t))throw new Error("tool is required and must be an array of Tools");return t}function Wn(o,t,e,n=1){const i=!t.startsWith(`${e}/`)&&t.split("/").length===n;return o.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${o.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}`:i?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}/${t}`:t:i?`${e}/${t}`:t}function b(o,t){if(typeof t!="string")throw new Error("name must be a string");return Wn(o,t,"cachedContents")}function _n(o,t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function J(o,t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function Xn(o){return o!=null&&typeof o=="object"&&"name"in o}function zn(o){return o!=null&&typeof o=="object"&&"video"in o}function On(o){return o!=null&&typeof o=="object"&&"uri"in o}function In(o,t){var e;let n;if(Xn(t)&&(n=t.name),!(On(t)&&(n=t.uri,n===void 0))&&!(zn(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const l=n.split("files/")[1].match(/[a-z0-9]+/);if(l===null)throw new Error(`Could not extract file name from URI ${n}`);n=l[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Sn(o,t){let e;return o.isVertexAI()?e=t?"publishers/google/models":"models":e=t?"models":"tunedModels",e}function An(o,t){for(const e of["models","tunedModels","publisherModels"])if(Qn(t,e))return t[e];return[]}function Qn(o,t){return o!==null&&typeof o=="object"&&t in o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zn(o,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&r(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function jn(o,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["inlineData"]);i!=null&&r(e,["inlineData"],Zn(o,i));const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const c=s(t,["fileData"]);c!=null&&r(e,["fileData"],c);const d=s(t,["functionCall"]);d!=null&&r(e,["functionCall"],d);const u=s(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function tt(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>jn(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function eo(){return{}}function to(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function no(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],to(o,n)),e}function oo(o,t){const e={};if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&r(e,["googleSearch"],eo());const i=s(t,["googleSearchRetrieval"]);if(i!=null&&r(e,["googleSearchRetrieval"],no(o,i)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=s(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=s(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function io(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function so(o,t){const e={},n=s(t,["functionCallingConfig"]);if(n!=null&&r(e,["functionCallingConfig"],io(o,n)),s(t,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return e}function ro(o,t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(t,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const a=s(t,["displayName"]);e!==void 0&&a!=null&&r(e,["displayName"],a);const c=s(t,["contents"]);if(e!==void 0&&c!=null){let p=$(o,c);Array.isArray(p)&&(p=p.map(m=>tt(o,m))),r(e,["contents"],p)}const d=s(t,["systemInstruction"]);e!==void 0&&d!=null&&r(e,["systemInstruction"],tt(o,N(o,d)));const u=s(t,["tools"]);if(e!==void 0&&u!=null){let p=u;Array.isArray(p)&&(p=p.map(m=>oo(o,m))),r(e,["tools"],p)}const f=s(t,["toolConfig"]);return e!==void 0&&f!=null&&r(e,["toolConfig"],so(o,f)),n}function lo(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],gn(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],ro(o,i,e)),e}function ao(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],b(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function uo(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],b(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function co(o,t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(t,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),n}function fo(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],b(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],co(o,i,e)),e}function po(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function mo(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],po(o,n,e)),e}function ho(o,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const i=s(t,["data"]);i!=null&&r(e,["data"],i);const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function go(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["inlineData"]);l!=null&&r(e,["inlineData"],ho(o,l));const a=s(t,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const c=s(t,["executableCode"]);c!=null&&r(e,["executableCode"],c);const d=s(t,["fileData"]);d!=null&&r(e,["fileData"],d);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function nt(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>go(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function yo(){return{}}function Co(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function To(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Co(o,n)),e}function vo(){return{}}function Eo(o,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function _o(o,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],Eo(o,n));const i=s(t,["authType"]);i!=null&&r(e,["authType"],i);const l=s(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=s(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const c=s(t,["oauthConfig"]);c!=null&&r(e,["oauthConfig"],c);const d=s(t,["oidcConfig"]);return d!=null&&r(e,["oidcConfig"],d),e}function Io(o,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],_o(o,n)),e}function So(o,t){const e={},n=s(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),s(t,["googleSearch"])!=null&&r(e,["googleSearch"],yo());const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],To(o,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],vo());const c=s(t,["googleMaps"]);c!=null&&r(e,["googleMaps"],Io(o,c));const d=s(t,["codeExecution"]);d!=null&&r(e,["codeExecution"],d);const u=s(t,["functionDeclarations"]);return u!=null&&r(e,["functionDeclarations"],u),e}function Ao(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function Mo(o,t){const e={},n=s(t,["latitude"]);n!=null&&r(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&r(e,["longitude"],i),e}function Po(o,t){const e={},n=s(t,["latLng"]);return n!=null&&r(e,["latLng"],Mo(o,n)),e}function xo(o,t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],Ao(o,n));const i=s(t,["retrievalConfig"]);return i!=null&&r(e,["retrievalConfig"],Po(o,i)),e}function Ro(o,t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(t,["expireTime"]);e!==void 0&&l!=null&&r(e,["expireTime"],l);const a=s(t,["displayName"]);e!==void 0&&a!=null&&r(e,["displayName"],a);const c=s(t,["contents"]);if(e!==void 0&&c!=null){let p=$(o,c);Array.isArray(p)&&(p=p.map(m=>nt(o,m))),r(e,["contents"],p)}const d=s(t,["systemInstruction"]);e!==void 0&&d!=null&&r(e,["systemInstruction"],nt(o,N(o,d)));const u=s(t,["tools"]);if(e!==void 0&&u!=null){let p=u;Array.isArray(p)&&(p=p.map(m=>So(o,m))),r(e,["tools"],p)}const f=s(t,["toolConfig"]);return e!==void 0&&f!=null&&r(e,["toolConfig"],xo(o,f)),n}function wo(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],gn(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Ro(o,i,e)),e}function Do(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],b(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function No(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],b(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Lo(o,t,e){const n={},i=s(t,["ttl"]);e!==void 0&&i!=null&&r(e,["ttl"],i);const l=s(t,["expireTime"]);return e!==void 0&&l!=null&&r(e,["expireTime"],l),n}function Vo(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],b(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Lo(o,i,e)),e}function ko(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function Uo(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],ko(o,n,e)),e}function ue(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["model"]);l!=null&&r(e,["model"],l);const a=s(t,["createTime"]);a!=null&&r(e,["createTime"],a);const c=s(t,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=s(t,["expireTime"]);d!=null&&r(e,["expireTime"],d);const u=s(t,["usageMetadata"]);return u!=null&&r(e,["usageMetadata"],u),e}function Fo(){return{}}function Go(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["cachedContents"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>ue(o,a))),r(e,["cachedContents"],l)}return e}function ce(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["model"]);l!=null&&r(e,["model"],l);const a=s(t,["createTime"]);a!=null&&r(e,["createTime"],a);const c=s(t,["updateTime"]);c!=null&&r(e,["updateTime"],c);const d=s(t,["expireTime"]);d!=null&&r(e,["expireTime"],d);const u=s(t,["usageMetadata"]);return u!=null&&r(e,["usageMetadata"],u),e}function qo(){return{}}function Bo(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["cachedContents"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>ce(o,a))),r(e,["cachedContents"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var X;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(X||(X={}));class Ee{constructor(t,e,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(t,n,i)}init(t,e,n){var i,l;this.nameInternal=t,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let a={config:{}};n?typeof n=="object"?a=Object.assign({},n):a=n:a={config:{}},a.config&&(a.config.pageToken=e.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(l=(i=a.config)===null||i===void 0?void 0:i.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ot;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ot||(ot={}));var it;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(it||(it={}));var st;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(st||(st={}));var rt;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(rt||(rt={}));var lt;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(lt||(lt={}));var at;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(at||(at={}));var ut;(function(o){o.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",o.NO_AUTH="NO_AUTH",o.API_KEY_AUTH="API_KEY_AUTH",o.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",o.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",o.OAUTH="OAUTH",o.OIDC_AUTH="OIDC_AUTH"})(ut||(ut={}));var H;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(H||(H={}));var ct;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.LANGUAGE="LANGUAGE",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})(ct||(ct={}));var dt;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(dt||(dt={}));var ft;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ft||(ft={}));var pt;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(pt||(pt={}));var mt;(function(o){o.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",o.ON_DEMAND="ON_DEMAND",o.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(mt||(mt={}));var pe;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(pe||(pe={}));var ht;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ht||(ht={}));var Fe;(function(o){o.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",o.JOB_STATE_QUEUED="JOB_STATE_QUEUED",o.JOB_STATE_PENDING="JOB_STATE_PENDING",o.JOB_STATE_RUNNING="JOB_STATE_RUNNING",o.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",o.JOB_STATE_FAILED="JOB_STATE_FAILED",o.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",o.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",o.JOB_STATE_PAUSED="JOB_STATE_PAUSED",o.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",o.JOB_STATE_UPDATING="JOB_STATE_UPDATING",o.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Fe||(Fe={}));var gt;(function(o){o.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",o.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",o.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",o.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",o.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",o.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",o.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(gt||(gt={}));var yt;(function(o){o.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",o.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",o.BALANCED="BALANCED",o.PRIORITIZE_COST="PRIORITIZE_COST"})(yt||(yt={}));var Ct;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Ct||(Ct={}));var Tt;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(Tt||(Tt={}));var vt;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(vt||(vt={}));var Et;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(Et||(Et={}));var _t;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(_t||(_t={}));var It;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(It||(It={}));var St;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(St||(St={}));var At;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(At||(At={}));var Mt;(function(o){o.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",o.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",o.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",o.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",o.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",o.EDIT_MODE_STYLE="EDIT_MODE_STYLE",o.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",o.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Mt||(Mt={}));var Pt;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(Pt||(Pt={}));var xt;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(xt||(xt={}));var Rt;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(Rt||(Rt={}));var wt;(function(o){o.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",o.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",o.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(wt||(wt={}));var Dt;(function(o){o.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",o.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",o.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Dt||(Dt={}));var Nt;(function(o){o.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",o.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",o.NO_INTERRUPTION="NO_INTERRUPTION"})(Nt||(Nt={}));var Lt;(function(o){o.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",o.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",o.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Lt||(Lt={}));class oe{get text(){var t,e,n,i,l,a,c,d;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",f=!1;const p=[];for(const m of(d=(c=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[h,g]of Object.entries(m))h!=="text"&&h!=="thought"&&(g!==null||g!==void 0)&&p.push(h);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;f=!0,u+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?u:void 0}get data(){var t,e,n,i,l,a,c,d;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const f=[];for(const p of(d=(c=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[m,h]of Object.entries(p))m!=="inlineData"&&(h!==null||h!==void 0)&&f.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var t,e,n,i,l,a,c,d;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(d=(c=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var t,e,n,i,l,a,c,d,u;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(d=(c=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var t,e,n,i,l,a,c,d,u;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(d=(c=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((f==null?void 0:f.length)!==0)return(u=f==null?void 0:f[0])===null||u===void 0?void 0:u.output}}class Vt{}class kt{}class Ho{}class $o{}class Ut{}class Ft{}class Gt{}class bo{}class qt{}class Bt{}class Ht{}class Jo{}class Ge{constructor(t){const e={};for(const n of t.headers.entries())e[n[0]]=n[1];this.headers=e,this.responseInternal=t}json(){return this.responseInternal.json()}}class Yo{}class Ko{}class Wo{get text(){var t,e,n;let i="",l=!1;const a=[];for(const c of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[d,u]of Object.entries(c))d!=="text"&&d!=="thought"&&u!==null&&a.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;l=!0,i+=c.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?i:void 0}get data(){var t,e,n;let i="";const l=[];for(const a of(n=(e=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||e===void 0?void 0:e.parts)!==null&&n!==void 0?n:[]){for(const[c,d]of Object.entries(a))c!=="inlineData"&&d!==null&&l.push(c);a.inlineData&&typeof a.inlineData.data=="string"&&(i+=atob(a.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xo extends ne{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new Ee(X.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(e),e)}async create(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=wo(this.apiClient,t);return c=T("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>ce(this.apiClient,f))}else{const u=lo(this.apiClient,t);return c=T("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>ue(this.apiClient,f))}}async get(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Do(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>ce(this.apiClient,f))}else{const u=ao(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>ue(this.apiClient,f))}}async delete(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=No(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(()=>{const f=qo(),p=new Bt;return Object.assign(p,f),p})}else{const u=uo(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Fo(),p=new Bt;return Object.assign(p,f),p})}}async update(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Vo(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>ce(this.apiClient,f))}else{const u=fo(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>ue(this.apiClient,f))}}async listInternal(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Uo(this.apiClient,t);return c=T("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Bo(this.apiClient,f),m=new Ht;return Object.assign(m,p),m})}else{const u=mo(this.apiClient,t);return c=T("cachedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Go(this.apiClient,f),m=new Ht;return Object.assign(m,p),m})}}}function $t(o){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&o[t],n=0;if(e)return e.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function D(o){return this instanceof D?(this.v=o,this):new D(o)}function me(o,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(o,t||[]),i,l=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(h){return function(g){return Promise.resolve(g).then(h,p)}}function c(h,g){n[h]&&(i[h]=function(y){return new Promise(function(C,E){l.push([h,y,C,E])>1||d(h,y)})},g&&(i[h]=g(i[h])))}function d(h,g){try{u(n[h](g))}catch(y){m(l[0][3],y)}}function u(h){h.value instanceof D?Promise.resolve(h.value.v).then(f,p):m(l[0][2],h)}function f(h){d("next",h)}function p(h){d("throw",h)}function m(h,g){h(g),l.shift(),l.length&&d(l[0][0],l[0][1])}}function qe(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],e;return t?t.call(o):(o=typeof $t=="function"?$t(o):o[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(l){e[l]=o[l]&&function(a){return new Promise(function(c,d){a=o[l](a),i(c,d,a.done,a.value)})}}function i(l,a,c,d){Promise.resolve(d).then(function(u){l({value:u,done:c})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zo(o){var t;if(o.candidates==null||o.candidates.length===0)return!1;const e=(t=o.candidates[0])===null||t===void 0?void 0:t.content;return e===void 0?!1:Mn(e)}function Mn(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const t of o.parts)if(t===void 0||Object.keys(t).length===0||t.text!==void 0&&t.text==="")return!1;return!0}function Oo(o){if(o.length!==0){if(o[0].role!=="user")throw new Error("History must start with a user turn.");for(const t of o)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function Qo(o){if(o===void 0||o.length===0)return[];const t=[],e=o.length;let n=0,i=o[0];for(;n<e;)if(o[n].role==="user")i=o[n],n++;else{const l=[];let a=!0;for(;n<e&&o[n].role==="model";)l.push(o[n]),a&&!Mn(o[n])&&(a=!1),n++;a&&(t.push(i),t.push(...l))}return t}class Zo{constructor(t,e){this.modelsModule=t,this.apiClient=e}create(t){return new jo(this.apiClient,this.modelsModule,t.model,t.config,t.history)}}class jo{constructor(t,e,n,i={},l=[]){this.apiClient=t,this.modelsModule=e,this.model=n,this.config=i,this.history=l,this.sendPromise=Promise.resolve(),Oo(l)}async sendMessage(t){var e;await this.sendPromise;const n=N(this.apiClient,t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var l,a;const d=(a=(l=(await i).candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content,u=d?[d]:[];this.recordHistory(n,u)})(),await this.sendPromise,i}async sendMessageStream(t){var e;await this.sendPromise;const n=N(this.apiClient,t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const l=await i;return this.processStreamResponse(l,n)}getHistory(t=!1){return t?Qo(this.history):this.history}processStreamResponse(t,e){var n,i;return me(this,arguments,function*(){var a,c,d,u;const f=[];try{for(var p=!0,m=qe(t),h;h=yield D(m.next()),a=h.done,!a;p=!0){u=h.value,p=!1;const g=u;if(zo(g)){const y=(i=(n=g.candidates)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.content;y!==void 0&&f.push(y)}yield yield D(g)}}catch(g){c={error:g}}finally{try{!p&&!a&&(d=m.return)&&(yield D(d.call(m)))}finally{if(c)throw c.error}}this.recordHistory(e,f)})}recordHistory(t,e){let n=[];e.length>0&&e.every(i=>i.role==="model")?n=e:n.push({role:"model",parts:[]}),this.history.push(t),this.history.push(...n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ei(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&r(e,["_query","pageToken"],l),n}function ti(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],ei(o,n,e)),e}function ni(o,t){const e={},n=s(t,["details"]);n!=null&&r(e,["details"],n);const i=s(t,["message"]);i!=null&&r(e,["message"],i);const l=s(t,["code"]);return l!=null&&r(e,["code"],l),e}function oi(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["mimeType"]);l!=null&&r(e,["mimeType"],l);const a=s(t,["sizeBytes"]);a!=null&&r(e,["sizeBytes"],a);const c=s(t,["createTime"]);c!=null&&r(e,["createTime"],c);const d=s(t,["expirationTime"]);d!=null&&r(e,["expirationTime"],d);const u=s(t,["updateTime"]);u!=null&&r(e,["updateTime"],u);const f=s(t,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=s(t,["uri"]);p!=null&&r(e,["uri"],p);const m=s(t,["downloadUri"]);m!=null&&r(e,["downloadUri"],m);const h=s(t,["state"]);h!=null&&r(e,["state"],h);const g=s(t,["source"]);g!=null&&r(e,["source"],g);const y=s(t,["videoMetadata"]);y!=null&&r(e,["videoMetadata"],y);const C=s(t,["error"]);return C!=null&&r(e,["error"],ni(o,C)),e}function ii(o,t){const e={},n=s(t,["file"]);n!=null&&r(e,["file"],oi(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function si(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","file"],In(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function ri(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","file"],In(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function li(o,t){const e={},n=s(t,["details"]);n!=null&&r(e,["details"],n);const i=s(t,["message"]);i!=null&&r(e,["message"],i);const l=s(t,["code"]);return l!=null&&r(e,["code"],l),e}function Be(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["mimeType"]);l!=null&&r(e,["mimeType"],l);const a=s(t,["sizeBytes"]);a!=null&&r(e,["sizeBytes"],a);const c=s(t,["createTime"]);c!=null&&r(e,["createTime"],c);const d=s(t,["expirationTime"]);d!=null&&r(e,["expirationTime"],d);const u=s(t,["updateTime"]);u!=null&&r(e,["updateTime"],u);const f=s(t,["sha256Hash"]);f!=null&&r(e,["sha256Hash"],f);const p=s(t,["uri"]);p!=null&&r(e,["uri"],p);const m=s(t,["downloadUri"]);m!=null&&r(e,["downloadUri"],m);const h=s(t,["state"]);h!=null&&r(e,["state"],h);const g=s(t,["source"]);g!=null&&r(e,["source"],g);const y=s(t,["videoMetadata"]);y!=null&&r(e,["videoMetadata"],y);const C=s(t,["error"]);return C!=null&&r(e,["error"],li(o,C)),e}function ai(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["files"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>Be(o,a))),r(e,["files"],l)}return e}function ui(){return{}}function ci(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class di extends ne{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new Ee(X.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(e),e)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(e=>Be(this.apiClient,e))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=ti(this.apiClient,t);return l=T("files",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const u=ai(this.apiClient,d),f=new Jo;return Object.assign(f,u),f})}}async createInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=ii(this.apiClient,t);return l=T("upload/v1beta/files",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(()=>{const d=ui(),u=new Yo;return Object.assign(u,d),u})}}async get(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=si(this.apiClient,t);return l=T("files/{file}",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>Be(this.apiClient,d))}}async delete(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=ri(this.apiClient,t);return l=T("files/{file}",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(()=>{const d=ci(),u=new Ko;return Object.assign(u,d),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fi(o,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&r(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function pi(o,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const i=s(t,["data"]);i!=null&&r(e,["data"],i);const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function mi(o,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["inlineData"]);i!=null&&r(e,["inlineData"],fi(o,i));const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const c=s(t,["fileData"]);c!=null&&r(e,["fileData"],c);const d=s(t,["functionCall"]);d!=null&&r(e,["functionCall"],d);const u=s(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function hi(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["inlineData"]);l!=null&&r(e,["inlineData"],pi(o,l));const a=s(t,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const c=s(t,["executableCode"]);c!=null&&r(e,["executableCode"],c);const d=s(t,["fileData"]);d!=null&&r(e,["fileData"],d);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function gi(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>mi(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function yi(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>hi(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function Ci(){return{}}function Ti(){return{}}function vi(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function Ei(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function _i(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],vi(o,n)),e}function Ii(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Ei(o,n)),e}function Si(){return{}}function Ai(o,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function Mi(o,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],Ai(o,n));const i=s(t,["authType"]);i!=null&&r(e,["authType"],i);const l=s(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=s(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const c=s(t,["oauthConfig"]);c!=null&&r(e,["oauthConfig"],c);const d=s(t,["oidcConfig"]);return d!=null&&r(e,["oidcConfig"],d),e}function Pi(o,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],Mi(o,n)),e}function xi(o,t){const e={};if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&r(e,["googleSearch"],Ci());const i=s(t,["googleSearchRetrieval"]);if(i!=null&&r(e,["googleSearchRetrieval"],_i(o,i)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=s(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=s(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function Ri(o,t){const e={},n=s(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),s(t,["googleSearch"])!=null&&r(e,["googleSearch"],Ti());const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],Ii(o,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],Si());const c=s(t,["googleMaps"]);c!=null&&r(e,["googleMaps"],Pi(o,c));const d=s(t,["codeExecution"]);d!=null&&r(e,["codeExecution"],d);const u=s(t,["functionDeclarations"]);return u!=null&&r(e,["functionDeclarations"],u),e}function wi(o,t){const e={},n=s(t,["handle"]);if(n!=null&&r(e,["handle"],n),s(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Di(o,t){const e={},n=s(t,["handle"]);n!=null&&r(e,["handle"],n);const i=s(t,["transparent"]);return i!=null&&r(e,["transparent"],i),e}function bt(){return{}}function Jt(){return{}}function Ni(o,t){const e={},n=s(t,["disabled"]);n!=null&&r(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&r(e,["startOfSpeechSensitivity"],i);const l=s(t,["endOfSpeechSensitivity"]);l!=null&&r(e,["endOfSpeechSensitivity"],l);const a=s(t,["prefixPaddingMs"]);a!=null&&r(e,["prefixPaddingMs"],a);const c=s(t,["silenceDurationMs"]);return c!=null&&r(e,["silenceDurationMs"],c),e}function Li(o,t){const e={},n=s(t,["disabled"]);n!=null&&r(e,["disabled"],n);const i=s(t,["startOfSpeechSensitivity"]);i!=null&&r(e,["startOfSpeechSensitivity"],i);const l=s(t,["endOfSpeechSensitivity"]);l!=null&&r(e,["endOfSpeechSensitivity"],l);const a=s(t,["prefixPaddingMs"]);a!=null&&r(e,["prefixPaddingMs"],a);const c=s(t,["silenceDurationMs"]);return c!=null&&r(e,["silenceDurationMs"],c),e}function Vi(o,t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&r(e,["automaticActivityDetection"],Ni(o,n));const i=s(t,["activityHandling"]);i!=null&&r(e,["activityHandling"],i);const l=s(t,["turnCoverage"]);return l!=null&&r(e,["turnCoverage"],l),e}function ki(o,t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&r(e,["automaticActivityDetection"],Li(o,n));const i=s(t,["activityHandling"]);i!=null&&r(e,["activityHandling"],i);const l=s(t,["turnCoverage"]);return l!=null&&r(e,["turnCoverage"],l),e}function Ui(o,t){const e={},n=s(t,["targetTokens"]);return n!=null&&r(e,["targetTokens"],n),e}function Fi(o,t){const e={},n=s(t,["targetTokens"]);return n!=null&&r(e,["targetTokens"],n),e}function Gi(o,t){const e={},n=s(t,["triggerTokens"]);n!=null&&r(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&r(e,["slidingWindow"],Ui(o,i)),e}function qi(o,t){const e={},n=s(t,["triggerTokens"]);n!=null&&r(e,["triggerTokens"],n);const i=s(t,["slidingWindow"]);return i!=null&&r(e,["slidingWindow"],Fi(o,i)),e}function Bi(o,t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&r(e,["setup","generationConfig"],i);const l=s(t,["responseModalities"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","responseModalities"],l);const a=s(t,["temperature"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","temperature"],a);const c=s(t,["topP"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","topP"],c);const d=s(t,["topK"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","topK"],d);const u=s(t,["maxOutputTokens"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","maxOutputTokens"],u);const f=s(t,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=s(t,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const m=s(t,["speechConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","speechConfig"],m);const h=s(t,["systemInstruction"]);e!==void 0&&h!=null&&r(e,["setup","systemInstruction"],gi(o,N(o,h)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let v=ve(o,g);Array.isArray(v)&&(v=v.map(M=>xi(o,Te(o,M)))),r(e,["setup","tools"],v)}const y=s(t,["sessionResumption"]);e!==void 0&&y!=null&&r(e,["setup","sessionResumption"],wi(o,y));const C=s(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&r(e,["setup","inputAudioTranscription"],bt());const E=s(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&r(e,["setup","outputAudioTranscription"],bt());const _=s(t,["realtimeInputConfig"]);e!==void 0&&_!=null&&r(e,["setup","realtimeInputConfig"],Vi(o,_));const I=s(t,["contextWindowCompression"]);return e!==void 0&&I!=null&&r(e,["setup","contextWindowCompression"],Gi(o,I)),n}function Hi(o,t,e){const n={},i=s(t,["generationConfig"]);e!==void 0&&i!=null&&r(e,["setup","generationConfig"],i);const l=s(t,["responseModalities"]);e!==void 0&&l!=null&&r(e,["setup","generationConfig","responseModalities"],l);const a=s(t,["temperature"]);e!==void 0&&a!=null&&r(e,["setup","generationConfig","temperature"],a);const c=s(t,["topP"]);e!==void 0&&c!=null&&r(e,["setup","generationConfig","topP"],c);const d=s(t,["topK"]);e!==void 0&&d!=null&&r(e,["setup","generationConfig","topK"],d);const u=s(t,["maxOutputTokens"]);e!==void 0&&u!=null&&r(e,["setup","generationConfig","maxOutputTokens"],u);const f=s(t,["mediaResolution"]);e!==void 0&&f!=null&&r(e,["setup","generationConfig","mediaResolution"],f);const p=s(t,["seed"]);e!==void 0&&p!=null&&r(e,["setup","generationConfig","seed"],p);const m=s(t,["speechConfig"]);e!==void 0&&m!=null&&r(e,["setup","generationConfig","speechConfig"],m);const h=s(t,["systemInstruction"]);e!==void 0&&h!=null&&r(e,["setup","systemInstruction"],yi(o,N(o,h)));const g=s(t,["tools"]);if(e!==void 0&&g!=null){let v=ve(o,g);Array.isArray(v)&&(v=v.map(M=>Ri(o,Te(o,M)))),r(e,["setup","tools"],v)}const y=s(t,["sessionResumption"]);e!==void 0&&y!=null&&r(e,["setup","sessionResumption"],Di(o,y));const C=s(t,["inputAudioTranscription"]);e!==void 0&&C!=null&&r(e,["setup","inputAudioTranscription"],Jt());const E=s(t,["outputAudioTranscription"]);e!==void 0&&E!=null&&r(e,["setup","outputAudioTranscription"],Jt());const _=s(t,["realtimeInputConfig"]);e!==void 0&&_!=null&&r(e,["setup","realtimeInputConfig"],ki(o,_));const I=s(t,["contextWindowCompression"]);return e!==void 0&&I!=null&&r(e,["setup","contextWindowCompression"],qi(o,I)),n}function $i(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["setup","model"],A(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Bi(o,i,e)),e}function bi(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["setup","model"],A(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Hi(o,i,e)),e}function Ji(){return{}}function Yi(){return{}}function Ki(){return{}}function Wi(){return{}}function Xi(o,t){const e={},n=s(t,["media"]);n!=null&&r(e,["mediaChunks"],yn(o,n));const i=s(t,["audio"]);i!=null&&r(e,["audio"],Kn(o,i));const l=s(t,["audioStreamEnd"]);l!=null&&r(e,["audioStreamEnd"],l);const a=s(t,["video"]);a!=null&&r(e,["video"],Yn(o,a));const c=s(t,["text"]);return c!=null&&r(e,["text"],c),s(t,["activityStart"])!=null&&r(e,["activityStart"],Ji()),s(t,["activityEnd"])!=null&&r(e,["activityEnd"],Ki()),e}function zi(o,t){const e={},n=s(t,["media"]);if(n!=null&&r(e,["mediaChunks"],yn(o,n)),s(t,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=s(t,["audioStreamEnd"]);if(i!=null&&r(e,["audioStreamEnd"],i),s(t,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(s(t,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return s(t,["activityStart"])!=null&&r(e,["activityStart"],Yi()),s(t,["activityEnd"])!=null&&r(e,["activityEnd"],Wi()),e}function Oi(){return{}}function Qi(){return{}}function Zi(o,t){const e={},n=s(t,["data"]);n!=null&&r(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function ji(o,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const i=s(t,["data"]);i!=null&&r(e,["data"],i);const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function es(o,t){const e={},n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["inlineData"]);i!=null&&r(e,["inlineData"],Zi(o,i));const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const c=s(t,["fileData"]);c!=null&&r(e,["fileData"],c);const d=s(t,["functionCall"]);d!=null&&r(e,["functionCall"],d);const u=s(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function ts(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["inlineData"]);l!=null&&r(e,["inlineData"],ji(o,l));const a=s(t,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const c=s(t,["executableCode"]);c!=null&&r(e,["executableCode"],c);const d=s(t,["fileData"]);d!=null&&r(e,["fileData"],d);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function ns(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>es(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function os(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>ts(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function Yt(o,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const i=s(t,["finished"]);return i!=null&&r(e,["finished"],i),e}function Kt(o,t){const e={},n=s(t,["text"]);n!=null&&r(e,["text"],n);const i=s(t,["finished"]);return i!=null&&r(e,["finished"],i),e}function is(o,t){const e={},n=s(t,["modelTurn"]);n!=null&&r(e,["modelTurn"],ns(o,n));const i=s(t,["turnComplete"]);i!=null&&r(e,["turnComplete"],i);const l=s(t,["interrupted"]);l!=null&&r(e,["interrupted"],l);const a=s(t,["groundingMetadata"]);a!=null&&r(e,["groundingMetadata"],a);const c=s(t,["generationComplete"]);c!=null&&r(e,["generationComplete"],c);const d=s(t,["inputTranscription"]);d!=null&&r(e,["inputTranscription"],Yt(o,d));const u=s(t,["outputTranscription"]);return u!=null&&r(e,["outputTranscription"],Yt(o,u)),e}function ss(o,t){const e={},n=s(t,["modelTurn"]);n!=null&&r(e,["modelTurn"],os(o,n));const i=s(t,["turnComplete"]);i!=null&&r(e,["turnComplete"],i);const l=s(t,["interrupted"]);l!=null&&r(e,["interrupted"],l);const a=s(t,["groundingMetadata"]);a!=null&&r(e,["groundingMetadata"],a);const c=s(t,["generationComplete"]);c!=null&&r(e,["generationComplete"],c);const d=s(t,["inputTranscription"]);d!=null&&r(e,["inputTranscription"],Kt(o,d));const u=s(t,["outputTranscription"]);return u!=null&&r(e,["outputTranscription"],Kt(o,u)),e}function rs(o,t){const e={},n=s(t,["id"]);n!=null&&r(e,["id"],n);const i=s(t,["args"]);i!=null&&r(e,["args"],i);const l=s(t,["name"]);return l!=null&&r(e,["name"],l),e}function ls(o,t){const e={},n=s(t,["args"]);n!=null&&r(e,["args"],n);const i=s(t,["name"]);return i!=null&&r(e,["name"],i),e}function as(o,t){const e={},n=s(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>rs(o,l))),r(e,["functionCalls"],i)}return e}function us(o,t){const e={},n=s(t,["functionCalls"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>ls(o,l))),r(e,["functionCalls"],i)}return e}function cs(o,t){const e={},n=s(t,["ids"]);return n!=null&&r(e,["ids"],n),e}function ds(o,t){const e={},n=s(t,["ids"]);return n!=null&&r(e,["ids"],n),e}function ie(o,t){const e={},n=s(t,["modality"]);n!=null&&r(e,["modality"],n);const i=s(t,["tokenCount"]);return i!=null&&r(e,["tokenCount"],i),e}function se(o,t){const e={},n=s(t,["modality"]);n!=null&&r(e,["modality"],n);const i=s(t,["tokenCount"]);return i!=null&&r(e,["tokenCount"],i),e}function fs(o,t){const e={},n=s(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const i=s(t,["cachedContentTokenCount"]);i!=null&&r(e,["cachedContentTokenCount"],i);const l=s(t,["responseTokenCount"]);l!=null&&r(e,["responseTokenCount"],l);const a=s(t,["toolUsePromptTokenCount"]);a!=null&&r(e,["toolUsePromptTokenCount"],a);const c=s(t,["thoughtsTokenCount"]);c!=null&&r(e,["thoughtsTokenCount"],c);const d=s(t,["totalTokenCount"]);d!=null&&r(e,["totalTokenCount"],d);const u=s(t,["promptTokensDetails"]);if(u!=null){let h=u;Array.isArray(h)&&(h=h.map(g=>ie(o,g))),r(e,["promptTokensDetails"],h)}const f=s(t,["cacheTokensDetails"]);if(f!=null){let h=f;Array.isArray(h)&&(h=h.map(g=>ie(o,g))),r(e,["cacheTokensDetails"],h)}const p=s(t,["responseTokensDetails"]);if(p!=null){let h=p;Array.isArray(h)&&(h=h.map(g=>ie(o,g))),r(e,["responseTokensDetails"],h)}const m=s(t,["toolUsePromptTokensDetails"]);if(m!=null){let h=m;Array.isArray(h)&&(h=h.map(g=>ie(o,g))),r(e,["toolUsePromptTokensDetails"],h)}return e}function ps(o,t){const e={},n=s(t,["promptTokenCount"]);n!=null&&r(e,["promptTokenCount"],n);const i=s(t,["cachedContentTokenCount"]);i!=null&&r(e,["cachedContentTokenCount"],i);const l=s(t,["candidatesTokenCount"]);l!=null&&r(e,["responseTokenCount"],l);const a=s(t,["toolUsePromptTokenCount"]);a!=null&&r(e,["toolUsePromptTokenCount"],a);const c=s(t,["thoughtsTokenCount"]);c!=null&&r(e,["thoughtsTokenCount"],c);const d=s(t,["totalTokenCount"]);d!=null&&r(e,["totalTokenCount"],d);const u=s(t,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(y=>se(o,y))),r(e,["promptTokensDetails"],g)}const f=s(t,["cacheTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(y=>se(o,y))),r(e,["cacheTokensDetails"],g)}const p=s(t,["candidatesTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>se(o,y))),r(e,["responseTokensDetails"],g)}const m=s(t,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(y=>se(o,y))),r(e,["toolUsePromptTokensDetails"],g)}const h=s(t,["trafficType"]);return h!=null&&r(e,["trafficType"],h),e}function ms(o,t){const e={},n=s(t,["timeLeft"]);return n!=null&&r(e,["timeLeft"],n),e}function hs(o,t){const e={},n=s(t,["timeLeft"]);return n!=null&&r(e,["timeLeft"],n),e}function gs(o,t){const e={},n=s(t,["newHandle"]);n!=null&&r(e,["newHandle"],n);const i=s(t,["resumable"]);i!=null&&r(e,["resumable"],i);const l=s(t,["lastConsumedClientMessageIndex"]);return l!=null&&r(e,["lastConsumedClientMessageIndex"],l),e}function ys(o,t){const e={},n=s(t,["newHandle"]);n!=null&&r(e,["newHandle"],n);const i=s(t,["resumable"]);i!=null&&r(e,["resumable"],i);const l=s(t,["lastConsumedClientMessageIndex"]);return l!=null&&r(e,["lastConsumedClientMessageIndex"],l),e}function Cs(o,t){const e={};s(t,["setupComplete"])!=null&&r(e,["setupComplete"],Oi());const i=s(t,["serverContent"]);i!=null&&r(e,["serverContent"],is(o,i));const l=s(t,["toolCall"]);l!=null&&r(e,["toolCall"],as(o,l));const a=s(t,["toolCallCancellation"]);a!=null&&r(e,["toolCallCancellation"],cs(o,a));const c=s(t,["usageMetadata"]);c!=null&&r(e,["usageMetadata"],fs(o,c));const d=s(t,["goAway"]);d!=null&&r(e,["goAway"],ms(o,d));const u=s(t,["sessionResumptionUpdate"]);return u!=null&&r(e,["sessionResumptionUpdate"],gs(o,u)),e}function Ts(o,t){const e={};s(t,["setupComplete"])!=null&&r(e,["setupComplete"],Qi());const i=s(t,["serverContent"]);i!=null&&r(e,["serverContent"],ss(o,i));const l=s(t,["toolCall"]);l!=null&&r(e,["toolCall"],us(o,l));const a=s(t,["toolCallCancellation"]);a!=null&&r(e,["toolCallCancellation"],ds(o,a));const c=s(t,["usageMetadata"]);c!=null&&r(e,["usageMetadata"],ps(o,c));const d=s(t,["goAway"]);d!=null&&r(e,["goAway"],hs(o,d));const u=s(t,["sessionResumptionUpdate"]);return u!=null&&r(e,["sessionResumptionUpdate"],ys(o,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vs(o,t){const e={};if(s(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=s(t,["data"]);n!=null&&r(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function Es(o,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["inlineData"]);i!=null&&r(e,["inlineData"],vs(o,i));const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const c=s(t,["fileData"]);c!=null&&r(e,["fileData"],c);const d=s(t,["functionCall"]);d!=null&&r(e,["functionCall"],d);const u=s(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function _e(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Es(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function _s(o,t){const e={};if(s(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=s(t,["category"]);n!=null&&r(e,["category"],n);const i=s(t,["threshold"]);return i!=null&&r(e,["threshold"],i),e}function Is(){return{}}function Ss(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function As(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],Ss(o,n)),e}function Ms(o,t){const e={};if(s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&r(e,["googleSearch"],Is());const i=s(t,["googleSearchRetrieval"]);if(i!=null&&r(e,["googleSearchRetrieval"],As(o,i)),s(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(s(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const l=s(t,["codeExecution"]);l!=null&&r(e,["codeExecution"],l);const a=s(t,["functionDeclarations"]);return a!=null&&r(e,["functionDeclarations"],a),e}function Ps(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function xs(o,t){const e={},n=s(t,["functionCallingConfig"]);if(n!=null&&r(e,["functionCallingConfig"],Ps(o,n)),s(t,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return e}function Rs(o,t){const e={},n=s(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function ws(o,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],Rs(o,n)),e}function Ds(o,t){const e={},n=s(t,["voiceConfig"]);n!=null&&r(e,["voiceConfig"],ws(o,n));const i=s(t,["languageCode"]);return i!=null&&r(e,["languageCode"],i),e}function Ns(o,t){const e={},n=s(t,["includeThoughts"]);n!=null&&r(e,["includeThoughts"],n);const i=s(t,["thinkingBudget"]);return i!=null&&r(e,["thinkingBudget"],i),e}function Ls(o,t,e){const n={},i=s(t,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],_e(o,N(o,i)));const l=s(t,["temperature"]);l!=null&&r(n,["temperature"],l);const a=s(t,["topP"]);a!=null&&r(n,["topP"],a);const c=s(t,["topK"]);c!=null&&r(n,["topK"],c);const d=s(t,["candidateCount"]);d!=null&&r(n,["candidateCount"],d);const u=s(t,["maxOutputTokens"]);u!=null&&r(n,["maxOutputTokens"],u);const f=s(t,["stopSequences"]);f!=null&&r(n,["stopSequences"],f);const p=s(t,["responseLogprobs"]);p!=null&&r(n,["responseLogprobs"],p);const m=s(t,["logprobs"]);m!=null&&r(n,["logprobs"],m);const h=s(t,["presencePenalty"]);h!=null&&r(n,["presencePenalty"],h);const g=s(t,["frequencyPenalty"]);g!=null&&r(n,["frequencyPenalty"],g);const y=s(t,["seed"]);y!=null&&r(n,["seed"],y);const C=s(t,["responseMimeType"]);C!=null&&r(n,["responseMimeType"],C);const E=s(t,["responseSchema"]);if(E!=null&&r(n,["responseSchema"],vn(o,E)),s(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(s(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=s(t,["safetySettings"]);if(e!==void 0&&_!=null){let P=_;Array.isArray(P)&&(P=P.map(w=>_s(o,w))),r(e,["safetySettings"],P)}const I=s(t,["tools"]);if(e!==void 0&&I!=null){let P=ve(o,I);Array.isArray(P)&&(P=P.map(w=>Ms(o,Te(o,w)))),r(e,["tools"],P)}const v=s(t,["toolConfig"]);if(e!==void 0&&v!=null&&r(e,["toolConfig"],xs(o,v)),s(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=s(t,["cachedContent"]);e!==void 0&&M!=null&&r(e,["cachedContent"],b(o,M));const V=s(t,["responseModalities"]);V!=null&&r(n,["responseModalities"],V);const G=s(t,["mediaResolution"]);G!=null&&r(n,["mediaResolution"],G);const k=s(t,["speechConfig"]);if(k!=null&&r(n,["speechConfig"],Ds(o,En(o,k))),s(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=s(t,["thinkingConfig"]);return B!=null&&r(n,["thinkingConfig"],Ns(o,B)),n}function Wt(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["contents"]);if(i!=null){let a=$(o,i);Array.isArray(a)&&(a=a.map(c=>_e(o,c))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["generationConfig"],Ls(o,l,e)),e}function Vs(o,t,e){const n={},i=s(t,["taskType"]);e!==void 0&&i!=null&&r(e,["requests[]","taskType"],i);const l=s(t,["title"]);e!==void 0&&l!=null&&r(e,["requests[]","title"],l);const a=s(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&r(e,["requests[]","outputDimensionality"],a),s(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(s(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ks(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["contents"]);i!=null&&r(e,["requests[]","content"],Tn(o,i));const l=s(t,["config"]);l!=null&&r(e,["config"],Vs(o,l,e));const a=s(t,["model"]);return a!==void 0&&r(e,["requests[]","model"],A(o,a)),e}function Us(o,t,e){const n={};if(s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=s(t,["numberOfImages"]);e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i);const l=s(t,["aspectRatio"]);e!==void 0&&l!=null&&r(e,["parameters","aspectRatio"],l);const a=s(t,["guidanceScale"]);if(e!==void 0&&a!=null&&r(e,["parameters","guidanceScale"],a),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=s(t,["safetyFilterLevel"]);e!==void 0&&c!=null&&r(e,["parameters","safetySetting"],c);const d=s(t,["personGeneration"]);e!==void 0&&d!=null&&r(e,["parameters","personGeneration"],d);const u=s(t,["includeSafetyAttributes"]);e!==void 0&&u!=null&&r(e,["parameters","includeSafetyAttributes"],u);const f=s(t,["includeRaiReason"]);e!==void 0&&f!=null&&r(e,["parameters","includeRaiReason"],f);const p=s(t,["language"]);e!==void 0&&p!=null&&r(e,["parameters","language"],p);const m=s(t,["outputMimeType"]);e!==void 0&&m!=null&&r(e,["parameters","outputOptions","mimeType"],m);const h=s(t,["outputCompressionQuality"]);if(e!==void 0&&h!=null&&r(e,["parameters","outputOptions","compressionQuality"],h),s(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Fs(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["config"]);return l!=null&&r(e,["config"],Us(o,l,e)),e}function Gs(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function qs(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=s(t,["filter"]);e!==void 0&&a!=null&&r(e,["_query","filter"],a);const c=s(t,["queryBase"]);return e!==void 0&&c!=null&&r(e,["_url","models_url"],Sn(o,c)),n}function Bs(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],qs(o,n,e)),e}function Hs(o,t,e){const n={},i=s(t,["displayName"]);e!==void 0&&i!=null&&r(e,["displayName"],i);const l=s(t,["description"]);e!==void 0&&l!=null&&r(e,["description"],l);const a=s(t,["defaultCheckpointId"]);return e!==void 0&&a!=null&&r(e,["defaultCheckpointId"],a),n}function $s(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Hs(o,i,e)),e}function bs(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Js(o,t){const e={};if(s(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(s(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(s(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Ys(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["contents"]);if(i!=null){let a=$(o,i);Array.isArray(a)&&(a=a.map(c=>_e(o,c))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["config"],Js(o,l)),e}function Ks(o,t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["imageBytes"]);n!=null&&r(e,["bytesBase64Encoded"],J(o,n));const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function Ws(o,t,e){const n={},i=s(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i),s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=s(t,["durationSeconds"]);if(e!==void 0&&l!=null&&r(e,["parameters","durationSeconds"],l),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=s(t,["aspectRatio"]);if(e!==void 0&&a!=null&&r(e,["parameters","aspectRatio"],a),s(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const c=s(t,["personGeneration"]);if(e!==void 0&&c!=null&&r(e,["parameters","personGeneration"],c),s(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=s(t,["negativePrompt"]);if(e!==void 0&&d!=null&&r(e,["parameters","negativePrompt"],d),s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Xs(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["image"]);l!=null&&r(e,["instances[0]","image"],Ks(o,l));const a=s(t,["config"]);return a!=null&&r(e,["config"],Ws(o,a,e)),e}function zs(o,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const i=s(t,["data"]);i!=null&&r(e,["data"],i);const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Os(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["inlineData"]);l!=null&&r(e,["inlineData"],zs(o,l));const a=s(t,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const c=s(t,["executableCode"]);c!=null&&r(e,["executableCode"],c);const d=s(t,["fileData"]);d!=null&&r(e,["fileData"],d);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function O(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Os(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function Qs(o,t){const e={},n=s(t,["featureSelectionPreference"]);return n!=null&&r(e,["featureSelectionPreference"],n),e}function Zs(o,t){const e={},n=s(t,["method"]);n!=null&&r(e,["method"],n);const i=s(t,["category"]);i!=null&&r(e,["category"],i);const l=s(t,["threshold"]);return l!=null&&r(e,["threshold"],l),e}function js(){return{}}function er(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["dynamicThreshold"]);return i!=null&&r(e,["dynamicThreshold"],i),e}function tr(o,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&r(e,["dynamicRetrievalConfig"],er(o,n)),e}function nr(){return{}}function or(o,t){const e={},n=s(t,["apiKeyString"]);return n!=null&&r(e,["apiKeyString"],n),e}function ir(o,t){const e={},n=s(t,["apiKeyConfig"]);n!=null&&r(e,["apiKeyConfig"],or(o,n));const i=s(t,["authType"]);i!=null&&r(e,["authType"],i);const l=s(t,["googleServiceAccountConfig"]);l!=null&&r(e,["googleServiceAccountConfig"],l);const a=s(t,["httpBasicAuthConfig"]);a!=null&&r(e,["httpBasicAuthConfig"],a);const c=s(t,["oauthConfig"]);c!=null&&r(e,["oauthConfig"],c);const d=s(t,["oidcConfig"]);return d!=null&&r(e,["oidcConfig"],d),e}function sr(o,t){const e={},n=s(t,["authConfig"]);return n!=null&&r(e,["authConfig"],ir(o,n)),e}function Pn(o,t){const e={},n=s(t,["retrieval"]);n!=null&&r(e,["retrieval"],n),s(t,["googleSearch"])!=null&&r(e,["googleSearch"],js());const l=s(t,["googleSearchRetrieval"]);l!=null&&r(e,["googleSearchRetrieval"],tr(o,l)),s(t,["enterpriseWebSearch"])!=null&&r(e,["enterpriseWebSearch"],nr());const c=s(t,["googleMaps"]);c!=null&&r(e,["googleMaps"],sr(o,c));const d=s(t,["codeExecution"]);d!=null&&r(e,["codeExecution"],d);const u=s(t,["functionDeclarations"]);return u!=null&&r(e,["functionDeclarations"],u),e}function rr(o,t){const e={},n=s(t,["mode"]);n!=null&&r(e,["mode"],n);const i=s(t,["allowedFunctionNames"]);return i!=null&&r(e,["allowedFunctionNames"],i),e}function lr(o,t){const e={},n=s(t,["latitude"]);n!=null&&r(e,["latitude"],n);const i=s(t,["longitude"]);return i!=null&&r(e,["longitude"],i),e}function ar(o,t){const e={},n=s(t,["latLng"]);return n!=null&&r(e,["latLng"],lr(o,n)),e}function ur(o,t){const e={},n=s(t,["functionCallingConfig"]);n!=null&&r(e,["functionCallingConfig"],rr(o,n));const i=s(t,["retrievalConfig"]);return i!=null&&r(e,["retrievalConfig"],ar(o,i)),e}function cr(o,t){const e={},n=s(t,["voiceName"]);return n!=null&&r(e,["voiceName"],n),e}function dr(o,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&r(e,["prebuiltVoiceConfig"],cr(o,n)),e}function fr(o,t){const e={},n=s(t,["voiceConfig"]);n!=null&&r(e,["voiceConfig"],dr(o,n));const i=s(t,["languageCode"]);return i!=null&&r(e,["languageCode"],i),e}function pr(o,t){const e={},n=s(t,["includeThoughts"]);n!=null&&r(e,["includeThoughts"],n);const i=s(t,["thinkingBudget"]);return i!=null&&r(e,["thinkingBudget"],i),e}function mr(o,t,e){const n={},i=s(t,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],O(o,N(o,i)));const l=s(t,["temperature"]);l!=null&&r(n,["temperature"],l);const a=s(t,["topP"]);a!=null&&r(n,["topP"],a);const c=s(t,["topK"]);c!=null&&r(n,["topK"],c);const d=s(t,["candidateCount"]);d!=null&&r(n,["candidateCount"],d);const u=s(t,["maxOutputTokens"]);u!=null&&r(n,["maxOutputTokens"],u);const f=s(t,["stopSequences"]);f!=null&&r(n,["stopSequences"],f);const p=s(t,["responseLogprobs"]);p!=null&&r(n,["responseLogprobs"],p);const m=s(t,["logprobs"]);m!=null&&r(n,["logprobs"],m);const h=s(t,["presencePenalty"]);h!=null&&r(n,["presencePenalty"],h);const g=s(t,["frequencyPenalty"]);g!=null&&r(n,["frequencyPenalty"],g);const y=s(t,["seed"]);y!=null&&r(n,["seed"],y);const C=s(t,["responseMimeType"]);C!=null&&r(n,["responseMimeType"],C);const E=s(t,["responseSchema"]);E!=null&&r(n,["responseSchema"],vn(o,E));const _=s(t,["routingConfig"]);_!=null&&r(n,["routingConfig"],_);const I=s(t,["modelSelectionConfig"]);I!=null&&r(n,["modelConfig"],Qs(o,I));const v=s(t,["safetySettings"]);if(e!==void 0&&v!=null){let q=v;Array.isArray(q)&&(q=q.map(Se=>Zs(o,Se))),r(e,["safetySettings"],q)}const M=s(t,["tools"]);if(e!==void 0&&M!=null){let q=ve(o,M);Array.isArray(q)&&(q=q.map(Se=>Pn(o,Te(o,Se)))),r(e,["tools"],q)}const V=s(t,["toolConfig"]);e!==void 0&&V!=null&&r(e,["toolConfig"],ur(o,V));const G=s(t,["labels"]);e!==void 0&&G!=null&&r(e,["labels"],G);const k=s(t,["cachedContent"]);e!==void 0&&k!=null&&r(e,["cachedContent"],b(o,k));const B=s(t,["responseModalities"]);B!=null&&r(n,["responseModalities"],B);const P=s(t,["mediaResolution"]);P!=null&&r(n,["mediaResolution"],P);const w=s(t,["speechConfig"]);w!=null&&r(n,["speechConfig"],fr(o,En(o,w)));const Oe=s(t,["audioTimestamp"]);Oe!=null&&r(n,["audioTimestamp"],Oe);const Qe=s(t,["thinkingConfig"]);return Qe!=null&&r(n,["thinkingConfig"],pr(o,Qe)),n}function Xt(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["contents"]);if(i!=null){let a=$(o,i);Array.isArray(a)&&(a=a.map(c=>O(o,c))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["generationConfig"],mr(o,l,e)),e}function hr(o,t,e){const n={},i=s(t,["taskType"]);e!==void 0&&i!=null&&r(e,["instances[]","task_type"],i);const l=s(t,["title"]);e!==void 0&&l!=null&&r(e,["instances[]","title"],l);const a=s(t,["outputDimensionality"]);e!==void 0&&a!=null&&r(e,["parameters","outputDimensionality"],a);const c=s(t,["mimeType"]);e!==void 0&&c!=null&&r(e,["instances[]","mimeType"],c);const d=s(t,["autoTruncate"]);return e!==void 0&&d!=null&&r(e,["parameters","autoTruncate"],d),n}function gr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["contents"]);i!=null&&r(e,["instances[]","content"],Tn(o,i));const l=s(t,["config"]);return l!=null&&r(e,["config"],hr(o,l,e)),e}function yr(o,t,e){const n={},i=s(t,["outputGcsUri"]);e!==void 0&&i!=null&&r(e,["parameters","storageUri"],i);const l=s(t,["negativePrompt"]);e!==void 0&&l!=null&&r(e,["parameters","negativePrompt"],l);const a=s(t,["numberOfImages"]);e!==void 0&&a!=null&&r(e,["parameters","sampleCount"],a);const c=s(t,["aspectRatio"]);e!==void 0&&c!=null&&r(e,["parameters","aspectRatio"],c);const d=s(t,["guidanceScale"]);e!==void 0&&d!=null&&r(e,["parameters","guidanceScale"],d);const u=s(t,["seed"]);e!==void 0&&u!=null&&r(e,["parameters","seed"],u);const f=s(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&r(e,["parameters","safetySetting"],f);const p=s(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=s(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&r(e,["parameters","includeSafetyAttributes"],m);const h=s(t,["includeRaiReason"]);e!==void 0&&h!=null&&r(e,["parameters","includeRaiReason"],h);const g=s(t,["language"]);e!==void 0&&g!=null&&r(e,["parameters","language"],g);const y=s(t,["outputMimeType"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","mimeType"],y);const C=s(t,["outputCompressionQuality"]);e!==void 0&&C!=null&&r(e,["parameters","outputOptions","compressionQuality"],C);const E=s(t,["addWatermark"]);e!==void 0&&E!=null&&r(e,["parameters","addWatermark"],E);const _=s(t,["enhancePrompt"]);return e!==void 0&&_!=null&&r(e,["parameters","enhancePrompt"],_),n}function Cr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["config"]);return l!=null&&r(e,["config"],yr(o,l,e)),e}function Ke(o,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const i=s(t,["imageBytes"]);i!=null&&r(e,["bytesBase64Encoded"],J(o,i));const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Tr(o,t){const e={},n=s(t,["maskMode"]);n!=null&&r(e,["maskMode"],n);const i=s(t,["segmentationClasses"]);i!=null&&r(e,["maskClasses"],i);const l=s(t,["maskDilation"]);return l!=null&&r(e,["dilation"],l),e}function vr(o,t){const e={},n=s(t,["controlType"]);n!=null&&r(e,["controlType"],n);const i=s(t,["enableControlImageComputation"]);return i!=null&&r(e,["computeControl"],i),e}function Er(o,t){const e={},n=s(t,["styleDescription"]);return n!=null&&r(e,["styleDescription"],n),e}function _r(o,t){const e={},n=s(t,["subjectType"]);n!=null&&r(e,["subjectType"],n);const i=s(t,["subjectDescription"]);return i!=null&&r(e,["subjectDescription"],i),e}function Ir(o,t){const e={},n=s(t,["referenceImage"]);n!=null&&r(e,["referenceImage"],Ke(o,n));const i=s(t,["referenceId"]);i!=null&&r(e,["referenceId"],i);const l=s(t,["referenceType"]);l!=null&&r(e,["referenceType"],l);const a=s(t,["maskImageConfig"]);a!=null&&r(e,["maskImageConfig"],Tr(o,a));const c=s(t,["controlImageConfig"]);c!=null&&r(e,["controlImageConfig"],vr(o,c));const d=s(t,["styleImageConfig"]);d!=null&&r(e,["styleImageConfig"],Er(o,d));const u=s(t,["subjectImageConfig"]);return u!=null&&r(e,["subjectImageConfig"],_r(o,u)),e}function Sr(o,t,e){const n={},i=s(t,["outputGcsUri"]);e!==void 0&&i!=null&&r(e,["parameters","storageUri"],i);const l=s(t,["negativePrompt"]);e!==void 0&&l!=null&&r(e,["parameters","negativePrompt"],l);const a=s(t,["numberOfImages"]);e!==void 0&&a!=null&&r(e,["parameters","sampleCount"],a);const c=s(t,["aspectRatio"]);e!==void 0&&c!=null&&r(e,["parameters","aspectRatio"],c);const d=s(t,["guidanceScale"]);e!==void 0&&d!=null&&r(e,["parameters","guidanceScale"],d);const u=s(t,["seed"]);e!==void 0&&u!=null&&r(e,["parameters","seed"],u);const f=s(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&r(e,["parameters","safetySetting"],f);const p=s(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=s(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&r(e,["parameters","includeSafetyAttributes"],m);const h=s(t,["includeRaiReason"]);e!==void 0&&h!=null&&r(e,["parameters","includeRaiReason"],h);const g=s(t,["language"]);e!==void 0&&g!=null&&r(e,["parameters","language"],g);const y=s(t,["outputMimeType"]);e!==void 0&&y!=null&&r(e,["parameters","outputOptions","mimeType"],y);const C=s(t,["outputCompressionQuality"]);e!==void 0&&C!=null&&r(e,["parameters","outputOptions","compressionQuality"],C);const E=s(t,["editMode"]);e!==void 0&&E!=null&&r(e,["parameters","editMode"],E);const _=s(t,["baseSteps"]);return e!==void 0&&_!=null&&r(e,["parameters","editConfig","baseSteps"],_),n}function Ar(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["referenceImages"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>Ir(o,d))),r(e,["instances[0]","referenceImages"],c)}const a=s(t,["config"]);return a!=null&&r(e,["config"],Sr(o,a,e)),e}function Mr(o,t,e){const n={},i=s(t,["includeRaiReason"]);e!==void 0&&i!=null&&r(e,["parameters","includeRaiReason"],i);const l=s(t,["outputMimeType"]);e!==void 0&&l!=null&&r(e,["parameters","outputOptions","mimeType"],l);const a=s(t,["outputCompressionQuality"]);e!==void 0&&a!=null&&r(e,["parameters","outputOptions","compressionQuality"],a);const c=s(t,["numberOfImages"]);e!==void 0&&c!=null&&r(e,["parameters","sampleCount"],c);const d=s(t,["mode"]);return e!==void 0&&d!=null&&r(e,["parameters","mode"],d),n}function Pr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["image"]);i!=null&&r(e,["instances[0]","image"],Ke(o,i));const l=s(t,["upscaleFactor"]);l!=null&&r(e,["parameters","upscaleConfig","upscaleFactor"],l);const a=s(t,["config"]);return a!=null&&r(e,["config"],Mr(o,a,e)),e}function xr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Rr(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=s(t,["filter"]);e!==void 0&&a!=null&&r(e,["_query","filter"],a);const c=s(t,["queryBase"]);return e!==void 0&&c!=null&&r(e,["_url","models_url"],Sn(o,c)),n}function wr(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],Rr(o,n,e)),e}function Dr(o,t,e){const n={},i=s(t,["displayName"]);e!==void 0&&i!=null&&r(e,["displayName"],i);const l=s(t,["description"]);e!==void 0&&l!=null&&r(e,["description"],l);const a=s(t,["defaultCheckpointId"]);return e!==void 0&&a!=null&&r(e,["defaultCheckpointId"],a),n}function Nr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],Dr(o,i,e)),e}function Lr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","name"],A(o,n));const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Vr(o,t,e){const n={},i=s(t,["systemInstruction"]);e!==void 0&&i!=null&&r(e,["systemInstruction"],O(o,N(o,i)));const l=s(t,["tools"]);if(e!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>Pn(o,d))),r(e,["tools"],c)}const a=s(t,["generationConfig"]);return e!==void 0&&a!=null&&r(e,["generationConfig"],a),n}function kr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["contents"]);if(i!=null){let a=$(o,i);Array.isArray(a)&&(a=a.map(c=>O(o,c))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["config"],Vr(o,l,e)),e}function Ur(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["contents"]);if(i!=null){let a=$(o,i);Array.isArray(a)&&(a=a.map(c=>O(o,c))),r(e,["contents"],a)}const l=s(t,["config"]);return l!=null&&r(e,["config"],l),e}function Fr(o,t,e){const n={},i=s(t,["numberOfVideos"]);e!==void 0&&i!=null&&r(e,["parameters","sampleCount"],i);const l=s(t,["outputGcsUri"]);e!==void 0&&l!=null&&r(e,["parameters","storageUri"],l);const a=s(t,["fps"]);e!==void 0&&a!=null&&r(e,["parameters","fps"],a);const c=s(t,["durationSeconds"]);e!==void 0&&c!=null&&r(e,["parameters","durationSeconds"],c);const d=s(t,["seed"]);e!==void 0&&d!=null&&r(e,["parameters","seed"],d);const u=s(t,["aspectRatio"]);e!==void 0&&u!=null&&r(e,["parameters","aspectRatio"],u);const f=s(t,["resolution"]);e!==void 0&&f!=null&&r(e,["parameters","resolution"],f);const p=s(t,["personGeneration"]);e!==void 0&&p!=null&&r(e,["parameters","personGeneration"],p);const m=s(t,["pubsubTopic"]);e!==void 0&&m!=null&&r(e,["parameters","pubsubTopic"],m);const h=s(t,["negativePrompt"]);e!==void 0&&h!=null&&r(e,["parameters","negativePrompt"],h);const g=s(t,["enhancePrompt"]);return e!==void 0&&g!=null&&r(e,["parameters","enhancePrompt"],g),n}function Gr(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["_url","model"],A(o,n));const i=s(t,["prompt"]);i!=null&&r(e,["instances[0]","prompt"],i);const l=s(t,["image"]);l!=null&&r(e,["instances[0]","image"],Ke(o,l));const a=s(t,["config"]);return a!=null&&r(e,["config"],Fr(o,a,e)),e}function qr(o,t){const e={},n=s(t,["data"]);n!=null&&r(e,["data"],n);const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function Br(o,t){const e={},n=s(t,["thought"]);n!=null&&r(e,["thought"],n);const i=s(t,["inlineData"]);i!=null&&r(e,["inlineData"],qr(o,i));const l=s(t,["codeExecutionResult"]);l!=null&&r(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&r(e,["executableCode"],a);const c=s(t,["fileData"]);c!=null&&r(e,["fileData"],c);const d=s(t,["functionCall"]);d!=null&&r(e,["functionCall"],d);const u=s(t,["functionResponse"]);u!=null&&r(e,["functionResponse"],u);const f=s(t,["text"]);return f!=null&&r(e,["text"],f),e}function Hr(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Br(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function $r(o,t){const e={},n=s(t,["citationSources"]);return n!=null&&r(e,["citations"],n),e}function br(o,t){const e={},n=s(t,["content"]);n!=null&&r(e,["content"],Hr(o,n));const i=s(t,["citationMetadata"]);i!=null&&r(e,["citationMetadata"],$r(o,i));const l=s(t,["tokenCount"]);l!=null&&r(e,["tokenCount"],l);const a=s(t,["finishReason"]);a!=null&&r(e,["finishReason"],a);const c=s(t,["avgLogprobs"]);c!=null&&r(e,["avgLogprobs"],c);const d=s(t,["groundingMetadata"]);d!=null&&r(e,["groundingMetadata"],d);const u=s(t,["index"]);u!=null&&r(e,["index"],u);const f=s(t,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=s(t,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function zt(o,t){const e={},n=s(t,["candidates"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>br(o,d))),r(e,["candidates"],c)}const i=s(t,["modelVersion"]);i!=null&&r(e,["modelVersion"],i);const l=s(t,["promptFeedback"]);l!=null&&r(e,["promptFeedback"],l);const a=s(t,["usageMetadata"]);return a!=null&&r(e,["usageMetadata"],a),e}function Jr(o,t){const e={},n=s(t,["values"]);return n!=null&&r(e,["values"],n),e}function Yr(){return{}}function Kr(o,t){const e={},n=s(t,["embeddings"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Jr(o,a))),r(e,["embeddings"],l)}return s(t,["metadata"])!=null&&r(e,["metadata"],Yr()),e}function Wr(o,t){const e={},n=s(t,["bytesBase64Encoded"]);n!=null&&r(e,["imageBytes"],J(o,n));const i=s(t,["mimeType"]);return i!=null&&r(e,["mimeType"],i),e}function xn(o,t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const i=s(t,["safetyAttributes","scores"]);i!=null&&r(e,["scores"],i);const l=s(t,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function Xr(o,t){const e={},n=s(t,["_self"]);n!=null&&r(e,["image"],Wr(o,n));const i=s(t,["raiFilteredReason"]);i!=null&&r(e,["raiFilteredReason"],i);const l=s(t,["_self"]);return l!=null&&r(e,["safetyAttributes"],xn(o,l)),e}function zr(o,t){const e={},n=s(t,["predictions"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>Xr(o,a))),r(e,["generatedImages"],l)}const i=s(t,["positivePromptSafetyAttributes"]);return i!=null&&r(e,["positivePromptSafetyAttributes"],xn(o,i)),e}function Or(o,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const i=s(t,["createTime"]);i!=null&&r(e,["createTime"],i);const l=s(t,["updateTime"]);return l!=null&&r(e,["updateTime"],l),e}function He(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["description"]);l!=null&&r(e,["description"],l);const a=s(t,["version"]);a!=null&&r(e,["version"],a);const c=s(t,["_self"]);c!=null&&r(e,["tunedModelInfo"],Or(o,c));const d=s(t,["inputTokenLimit"]);d!=null&&r(e,["inputTokenLimit"],d);const u=s(t,["outputTokenLimit"]);u!=null&&r(e,["outputTokenLimit"],u);const f=s(t,["supportedGenerationMethods"]);return f!=null&&r(e,["supportedActions"],f),e}function Qr(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["_self"]);if(i!=null){let l=An(o,i);Array.isArray(l)&&(l=l.map(a=>He(o,a))),r(e,["models"],l)}return e}function Zr(){return{}}function jr(o,t){const e={},n=s(t,["totalTokens"]);n!=null&&r(e,["totalTokens"],n);const i=s(t,["cachedContentTokenCount"]);return i!=null&&r(e,["cachedContentTokenCount"],i),e}function el(o,t){const e={},n=s(t,["video","uri"]);n!=null&&r(e,["uri"],n);const i=s(t,["video","encodedVideo"]);i!=null&&r(e,["videoBytes"],J(o,i));const l=s(t,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function tl(o,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],el(o,n)),e}function nl(o,t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>tl(o,c))),r(e,["generatedVideos"],a)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function ol(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);a!=null&&r(e,["error"],a);const c=s(t,["response","generateVideoResponse"]);return c!=null&&r(e,["response"],nl(o,c)),e}function il(o,t){const e={},n=s(t,["displayName"]);n!=null&&r(e,["displayName"],n);const i=s(t,["data"]);i!=null&&r(e,["data"],i);const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function sl(o,t){const e={},n=s(t,["videoMetadata"]);n!=null&&r(e,["videoMetadata"],n);const i=s(t,["thought"]);i!=null&&r(e,["thought"],i);const l=s(t,["inlineData"]);l!=null&&r(e,["inlineData"],il(o,l));const a=s(t,["codeExecutionResult"]);a!=null&&r(e,["codeExecutionResult"],a);const c=s(t,["executableCode"]);c!=null&&r(e,["executableCode"],c);const d=s(t,["fileData"]);d!=null&&r(e,["fileData"],d);const u=s(t,["functionCall"]);u!=null&&r(e,["functionCall"],u);const f=s(t,["functionResponse"]);f!=null&&r(e,["functionResponse"],f);const p=s(t,["text"]);return p!=null&&r(e,["text"],p),e}function rl(o,t){const e={},n=s(t,["parts"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>sl(o,a))),r(e,["parts"],l)}const i=s(t,["role"]);return i!=null&&r(e,["role"],i),e}function ll(o,t){const e={},n=s(t,["citations"]);return n!=null&&r(e,["citations"],n),e}function al(o,t){const e={},n=s(t,["content"]);n!=null&&r(e,["content"],rl(o,n));const i=s(t,["citationMetadata"]);i!=null&&r(e,["citationMetadata"],ll(o,i));const l=s(t,["finishMessage"]);l!=null&&r(e,["finishMessage"],l);const a=s(t,["finishReason"]);a!=null&&r(e,["finishReason"],a);const c=s(t,["avgLogprobs"]);c!=null&&r(e,["avgLogprobs"],c);const d=s(t,["groundingMetadata"]);d!=null&&r(e,["groundingMetadata"],d);const u=s(t,["index"]);u!=null&&r(e,["index"],u);const f=s(t,["logprobsResult"]);f!=null&&r(e,["logprobsResult"],f);const p=s(t,["safetyRatings"]);return p!=null&&r(e,["safetyRatings"],p),e}function Ot(o,t){const e={},n=s(t,["candidates"]);if(n!=null){let u=n;Array.isArray(u)&&(u=u.map(f=>al(o,f))),r(e,["candidates"],u)}const i=s(t,["createTime"]);i!=null&&r(e,["createTime"],i);const l=s(t,["responseId"]);l!=null&&r(e,["responseId"],l);const a=s(t,["modelVersion"]);a!=null&&r(e,["modelVersion"],a);const c=s(t,["promptFeedback"]);c!=null&&r(e,["promptFeedback"],c);const d=s(t,["usageMetadata"]);return d!=null&&r(e,["usageMetadata"],d),e}function ul(o,t){const e={},n=s(t,["truncated"]);n!=null&&r(e,["truncated"],n);const i=s(t,["token_count"]);return i!=null&&r(e,["tokenCount"],i),e}function cl(o,t){const e={},n=s(t,["values"]);n!=null&&r(e,["values"],n);const i=s(t,["statistics"]);return i!=null&&r(e,["statistics"],ul(o,i)),e}function dl(o,t){const e={},n=s(t,["billableCharacterCount"]);return n!=null&&r(e,["billableCharacterCount"],n),e}function fl(o,t){const e={},n=s(t,["predictions[]","embeddings"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>cl(o,a))),r(e,["embeddings"],l)}const i=s(t,["metadata"]);return i!=null&&r(e,["metadata"],dl(o,i)),e}function pl(o,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["gcsUri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&r(e,["imageBytes"],J(o,i));const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Rn(o,t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&r(e,["categories"],n);const i=s(t,["safetyAttributes","scores"]);i!=null&&r(e,["scores"],i);const l=s(t,["contentType"]);return l!=null&&r(e,["contentType"],l),e}function We(o,t){const e={},n=s(t,["_self"]);n!=null&&r(e,["image"],pl(o,n));const i=s(t,["raiFilteredReason"]);i!=null&&r(e,["raiFilteredReason"],i);const l=s(t,["_self"]);l!=null&&r(e,["safetyAttributes"],Rn(o,l));const a=s(t,["prompt"]);return a!=null&&r(e,["enhancedPrompt"],a),e}function ml(o,t){const e={},n=s(t,["predictions"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(a=>We(o,a))),r(e,["generatedImages"],l)}const i=s(t,["positivePromptSafetyAttributes"]);return i!=null&&r(e,["positivePromptSafetyAttributes"],Rn(o,i)),e}function hl(o,t){const e={},n=s(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>We(o,l))),r(e,["generatedImages"],i)}return e}function gl(o,t){const e={},n=s(t,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>We(o,l))),r(e,["generatedImages"],i)}return e}function yl(o,t){const e={},n=s(t,["endpoint"]);n!=null&&r(e,["name"],n);const i=s(t,["deployedModelId"]);return i!=null&&r(e,["deployedModelId"],i),e}function Cl(o,t){const e={},n=s(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&r(e,["baseModel"],n);const i=s(t,["createTime"]);i!=null&&r(e,["createTime"],i);const l=s(t,["updateTime"]);return l!=null&&r(e,["updateTime"],l),e}function Tl(o,t){const e={},n=s(t,["checkpointId"]);n!=null&&r(e,["checkpointId"],n);const i=s(t,["epoch"]);i!=null&&r(e,["epoch"],i);const l=s(t,["step"]);return l!=null&&r(e,["step"],l),e}function $e(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["displayName"]);i!=null&&r(e,["displayName"],i);const l=s(t,["description"]);l!=null&&r(e,["description"],l);const a=s(t,["versionId"]);a!=null&&r(e,["version"],a);const c=s(t,["deployedModels"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>yl(o,h))),r(e,["endpoints"],m)}const d=s(t,["labels"]);d!=null&&r(e,["labels"],d);const u=s(t,["_self"]);u!=null&&r(e,["tunedModelInfo"],Cl(o,u));const f=s(t,["defaultCheckpointId"]);f!=null&&r(e,["defaultCheckpointId"],f);const p=s(t,["checkpoints"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(h=>Tl(o,h))),r(e,["checkpoints"],m)}return e}function vl(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["_self"]);if(i!=null){let l=An(o,i);Array.isArray(l)&&(l=l.map(a=>$e(o,a))),r(e,["models"],l)}return e}function El(){return{}}function _l(o,t){const e={},n=s(t,["totalTokens"]);return n!=null&&r(e,["totalTokens"],n),e}function Il(o,t){const e={},n=s(t,["tokensInfo"]);return n!=null&&r(e,["tokensInfo"],n),e}function Sl(o,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&r(e,["videoBytes"],J(o,i));const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Al(o,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],Sl(o,n)),e}function Ml(o,t){const e={},n=s(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>Al(o,c))),r(e,["generatedVideos"],a)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function Pl(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);a!=null&&r(e,["error"],a);const c=s(t,["response"]);return c!=null&&r(e,["response"],Ml(o,c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xl="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Rl(o,t,e){const n=new Wo;let i;if(e.data instanceof Blob?i=JSON.parse(await e.data.text()):i=JSON.parse(e.data),o.isVertexAI()){const l=Ts(o,i);Object.assign(n,l)}else{const l=Cs(o,i);Object.assign(n,l)}t(n)}class wl{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n}async connect(t){var e,n,i,l;const a=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let d;const u=Vl(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())d=`${a}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const v=this.apiClient.getApiKey();d=`${a}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateContent?key=${v}`}let f=()=>{};const p=new Promise(v=>{f=v}),m=t.callbacks,h=function(){var v;(v=m==null?void 0:m.onopen)===null||v===void 0||v.call(m),f({})},g=this.apiClient,y={onopen:h,onmessage:v=>{Rl(g,m.onmessage,v)},onerror:(e=m==null?void 0:m.onerror)!==null&&e!==void 0?e:function(v){},onclose:(n=m==null?void 0:m.onclose)!==null&&n!==void 0?n:function(v){}},C=this.webSocketFactory.create(d,Ll(u),y);C.connect(),await p;let E=A(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&E.startsWith("publishers/")){const v=this.apiClient.getProject(),M=this.apiClient.getLocation();E=`projects/${v}/locations/${M}/`+E}let _={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[pe.AUDIO]}:t.config.responseModalities=[pe.AUDIO]),!((l=t.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I={model:E,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?_=bi(this.apiClient,I):_=$i(this.apiClient,I),delete _.config,C.send(JSON.stringify(_)),new Nl(C,this.apiClient)}}const Dl={turnComplete:!0};class Nl{constructor(t,e){this.conn=t,this.apiClient=e}tLiveClientContent(t,e){if(e.turns!==null&&e.turns!==void 0){let n=[];try{n=$(t,e.turns),t.isVertexAI()?n=n.map(i=>O(t,i)):n=n.map(i=>_e(t,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:n,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClienttToolResponse(t,e){let n=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?n=e.functionResponses:n=[e.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const l of n){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!t.isVertexAI()&&!("id"in l))throw new Error(xl)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},Dl),t);const e=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendRealtimeInput(t){let e={};this.apiClient.isVertexAI()?e={realtimeInput:zi(this.apiClient,t)}:e={realtimeInput:Xi(this.apiClient,t)},this.conn.send(JSON.stringify(e))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function Ll(o){const t={};return o.forEach((e,n)=>{t[n]=e}),t}function Vl(o){const t=new Headers;for(const[e,n]of Object.entries(o))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kl extends ne{constructor(t){super(),this.apiClient=t,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e),this.generateImages=async e=>await this.generateImagesInternal(e).then(n=>{var i;let l;const a=[];if(n!=null&&n.generatedImages)for(const d of n.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?l=d==null?void 0:d.safetyAttributes:a.push(d);let c;return l?c={generatedImages:a,positivePromptSafetyAttributes:l}:c={generatedImages:a},c}),this.list=async e=>{var n;const a={config:Object.assign(Object.assign({},{queryBase:!0}),e==null?void 0:e.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((n=a.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new Ee(X.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(a),a)},this.editImage=async e=>{const n={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(n.referenceImages=e.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async e=>{let n={numberOfImages:1,mode:"upscale"};e.config&&(n=Object.assign(Object.assign({},n),e.config));const i={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:n};return await this.upscaleImageInternal(i)}}async generateContentInternal(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Xt(this.apiClient,t);return c=T("{model}:generateContent",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ot(this.apiClient,f),m=new oe;return Object.assign(m,p),m})}else{const u=Wt(this.apiClient,t);return c=T("{model}:generateContent",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=zt(this.apiClient,f),m=new oe;return Object.assign(m,p),m})}}async generateContentStreamInternal(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Xt(this.apiClient,t);c=T("{model}:streamGenerateContent?alt=sse",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const f=this.apiClient;return a=f.requestStream({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}),a.then(function(p){return me(this,arguments,function*(){var m,h,g,y;try{for(var C=!0,E=qe(p),_;_=yield D(E.next()),m=_.done,!m;C=!0){y=_.value,C=!1;const v=Ot(f,yield D(y.json())),M=new oe;Object.assign(M,v),yield yield D(M)}}catch(I){h={error:I}}finally{try{!C&&!m&&(g=E.return)&&(yield D(g.call(E)))}finally{if(h)throw h.error}}})})}else{const u=Wt(this.apiClient,t);c=T("{model}:streamGenerateContent?alt=sse",u._url),d=u._query,delete u.config,delete u._url,delete u._query;const f=this.apiClient;return a=f.requestStream({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}),a.then(function(p){return me(this,arguments,function*(){var m,h,g,y;try{for(var C=!0,E=qe(p),_;_=yield D(E.next()),m=_.done,!m;C=!0){y=_.value,C=!1;const v=zt(f,yield D(y.json())),M=new oe;Object.assign(M,v),yield yield D(M)}}catch(I){h={error:I}}finally{try{!C&&!m&&(g=E.return)&&(yield D(g.call(E)))}finally{if(h)throw h.error}}})})}}async embedContent(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=gr(this.apiClient,t);return c=T("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=fl(this.apiClient,f),m=new Vt;return Object.assign(m,p),m})}else{const u=ks(this.apiClient,t);return c=T("{model}:batchEmbedContents",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Kr(this.apiClient,f),m=new Vt;return Object.assign(m,p),m})}}async generateImagesInternal(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Cr(this.apiClient,t);return c=T("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=ml(this.apiClient,f),m=new kt;return Object.assign(m,p),m})}else{const u=Fs(this.apiClient,t);return c=T("{model}:predict",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=zr(this.apiClient,f),m=new kt;return Object.assign(m,p),m})}}async editImageInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const c=Ar(this.apiClient,t);return l=T("{model}:predict",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const u=hl(this.apiClient,d),f=new Ho;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const c=Pr(this.apiClient,t);return l=T("{model}:predict",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const u=gl(this.apiClient,d),f=new $o;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=xr(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>$e(this.apiClient,f))}else{const u=Gs(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>He(this.apiClient,f))}}async listInternal(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=wr(this.apiClient,t);return c=T("{models_url}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=vl(this.apiClient,f),m=new Ut;return Object.assign(m,p),m})}else{const u=Bs(this.apiClient,t);return c=T("{models_url}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Qr(this.apiClient,f),m=new Ut;return Object.assign(m,p),m})}}async update(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Nr(this.apiClient,t);return c=T("{model}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>$e(this.apiClient,f))}else{const u=$s(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>He(this.apiClient,f))}}async delete(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Lr(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(()=>{const f=El(),p=new Ft;return Object.assign(p,f),p})}else{const u=bs(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(()=>{const f=Zr(),p=new Ft;return Object.assign(p,f),p})}}async countTokens(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=kr(this.apiClient,t);return c=T("{model}:countTokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=_l(this.apiClient,f),m=new Gt;return Object.assign(m,p),m})}else{const u=Ys(this.apiClient,t);return c=T("{model}:countTokens",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=jr(this.apiClient,f),m=new Gt;return Object.assign(m,p),m})}}async computeTokens(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const c=Ur(this.apiClient,t);return l=T("{model}:computeTokens",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>{const u=Il(this.apiClient,d),f=new bo;return Object.assign(f,u),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Gr(this.apiClient,t);return c=T("{model}:predictLongRunning",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>Pl(this.apiClient,f))}else{const u=Xs(this.apiClient,t);return c=T("{model}:predictLongRunning",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>ol(this.apiClient,f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ul(o,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["_url","operationName"],n);const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Fl(o,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["_url","operationName"],n);const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function Gl(o,t){const e={},n=s(t,["operationName"]);n!=null&&r(e,["operationName"],n);const i=s(t,["resourceName"]);i!=null&&r(e,["_url","resourceName"],i);const l=s(t,["config"]);return l!=null&&r(e,["config"],l),e}function ql(o,t){const e={},n=s(t,["video","uri"]);n!=null&&r(e,["uri"],n);const i=s(t,["video","encodedVideo"]);i!=null&&r(e,["videoBytes"],J(o,i));const l=s(t,["encoding"]);return l!=null&&r(e,["mimeType"],l),e}function Bl(o,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],ql(o,n)),e}function Hl(o,t){const e={},n=s(t,["generatedSamples"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>Bl(o,c))),r(e,["generatedVideos"],a)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function $l(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);a!=null&&r(e,["error"],a);const c=s(t,["response","generateVideoResponse"]);return c!=null&&r(e,["response"],Hl(o,c)),e}function bl(o,t){const e={},n=s(t,["gcsUri"]);n!=null&&r(e,["uri"],n);const i=s(t,["bytesBase64Encoded"]);i!=null&&r(e,["videoBytes"],J(o,i));const l=s(t,["mimeType"]);return l!=null&&r(e,["mimeType"],l),e}function Jl(o,t){const e={},n=s(t,["_self"]);return n!=null&&r(e,["video"],bl(o,n)),e}function Yl(o,t){const e={},n=s(t,["videos"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(c=>Jl(o,c))),r(e,["generatedVideos"],a)}const i=s(t,["raiMediaFilteredCount"]);i!=null&&r(e,["raiMediaFilteredCount"],i);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&r(e,["raiMediaFilteredReasons"],l),e}function Qt(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);a!=null&&r(e,["error"],a);const c=s(t,["response"]);return c!=null&&r(e,["response"],Yl(o,c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kl extends ne{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const e=t.operation,n=t.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=e.name.split("/operations/")[0];let l;return n&&"httpOptions"in n&&(l=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:i,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:e.name,config:n})}async getVideosOperationInternal(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=Fl(this.apiClient,t);return c=T("{operationName}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>Qt(this.apiClient,f))}else{const u=Ul(this.apiClient,t);return c=T("{operationName}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>$l(this.apiClient,f))}}async fetchPredictVideosOperationInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const c=Gl(this.apiClient,t);return l=T("{resourceName}:fetchPredictOperation",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>Qt(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Wl="Content-Type",Xl="X-Server-Timeout",zl="User-Agent",Ol="x-goog-api-client",Ql="0.14.1",Zl=`google-genai-sdk/${Ql}`,jl="v1beta1",ea="v1beta",Zt=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class wn extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ClientError"}}class be extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ServerError"}}class ta{constructor(t){var e,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:jl,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:ea,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),e=new URL(t);return e.protocol=e.protocol=="http:"?"ws":"wss",e.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,e,n){const i=[this.getRequestUrlInternal(e)];return n&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,e,n);if(t.queryParams)for(const[a,c]of Object.entries(t.queryParams))i.searchParams.append(a,String(c));let l={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=t.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,e,t.abortSignal),this.unaryApiCall(i,l,t.httpMethod)}patchHttpOptions(t,e){const n=JSON.parse(JSON.stringify(t));for(const[i,l]of Object.entries(e))typeof l=="object"?n[i]=Object.assign(Object.assign({},n[i]),l):l!==void 0&&(n[i]=l);return n}async requestStream(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,e,n);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let l={};return l.body=t.body,l=await this.includeExtraHttpOptionsToRequestInit(l,e,t.abortSignal),this.streamApiCall(i,l,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,e,n){if(e&&e.timeout||n){const i=new AbortController,l=i.signal;e.timeout&&(e==null?void 0:e.timeout)>0&&setTimeout(()=>i.abort(),e.timeout),n&&n.addEventListener("abort",()=>{i.abort()}),t.signal=l}return t.headers=await this.getHeadersInternal(e),t}async unaryApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async i=>(await jt(i),new Ge(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async i=>(await jt(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var e;return me(this,arguments,function*(){const i=(e=t==null?void 0:t.body)===null||e===void 0?void 0:e.getReader(),l=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let a="";for(;;){const{done:c,value:d}=yield D(i.read());if(c){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=l.decode(d);try{const p=JSON.parse(u);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),h=m.status,g=m.code,y=`got status: ${h}. ${JSON.stringify(p)}`;if(g>=400&&g<500)throw new wn(y);if(g>=500&&g<600)throw new be(y)}}catch(p){const m=p;if(m.name==="ClientError"||m.name==="ServerError")throw p}a+=u;let f=a.match(Zt);for(;f;){const p=f[1];try{const m=new Response(p,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield D(new Ge(m)),a=a.slice(f[0].length),f=a.match(Zt)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(t,e){return fetch(t,e).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},e=Zl+" "+this.clientOptions.userAgentExtra;return t[zl]=e,t[Ol]=e,t[Wl]="application/json",t}async getHeadersInternal(t){const e=new Headers;if(t&&t.headers){for(const[n,i]of Object.entries(t.headers))e.append(n,i);t.timeout&&t.timeout>0&&e.append(Xl,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(t,e){var n;const i={};e!=null&&(i.mimeType=e.mimeType,i.name=e.name,i.displayName=e.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const l=this.clientOptions.uploader,a=await l.stat(t);i.sizeBytes=String(a.size);const c=(n=e==null?void 0:e.mimeType)!==null&&n!==void 0?n:a.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=c;const d=await this.fetchUploadUrl(i,e);return l.upload(t,d,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,e){var n;let i={};e!=null&&e.httpOptions?i=e.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const l={file:t},a=await this.request({path:T("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:i});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(n=a==null?void 0:a.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function jt(o){var t;if(o===void 0)throw new be("response is undefined");if(!o.ok){const e=o.status,n=o.statusText;let i;!((t=o.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?i=await o.json():i={error:{message:await o.text(),code:o.status,status:o.statusText}};const l=`got status: ${e} ${n}. ${JSON.stringify(i)}`;throw e>=400&&e<500?new wn(l):e>=500&&e<600?new be(l):new Error(l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function na(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],n);const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function oa(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=s(t,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),n}function ia(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],oa(o,n,e)),e}function sa(o,t){const e={},n=s(t,["textInput"]);n!=null&&r(e,["textInput"],n);const i=s(t,["output"]);return i!=null&&r(e,["output"],i),e}function ra(o,t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>sa(o,l))),r(e,["examples","examples"],i)}return e}function la(o,t,e){const n={};if(s(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=s(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&r(e,["displayName"],i),s(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=s(t,["epochCount"]);e!==void 0&&l!=null&&r(e,["tuningTask","hyperparameters","epochCount"],l);const a=s(t,["learningRateMultiplier"]);if(a!=null&&r(n,["tuningTask","hyperparameters","learningRateMultiplier"],a),s(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(s(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=s(t,["batchSize"]);e!==void 0&&c!=null&&r(e,["tuningTask","hyperparameters","batchSize"],c);const d=s(t,["learningRate"]);return e!==void 0&&d!=null&&r(e,["tuningTask","hyperparameters","learningRate"],d),n}function aa(o,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const i=s(t,["trainingDataset"]);i!=null&&r(e,["tuningTask","trainingData"],ra(o,i));const l=s(t,["config"]);return l!=null&&r(e,["config"],la(o,l,e)),e}function ua(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["_url","name"],n);const i=s(t,["config"]);return i!=null&&r(e,["config"],i),e}function ca(o,t,e){const n={},i=s(t,["pageSize"]);e!==void 0&&i!=null&&r(e,["_query","pageSize"],i);const l=s(t,["pageToken"]);e!==void 0&&l!=null&&r(e,["_query","pageToken"],l);const a=s(t,["filter"]);return e!==void 0&&a!=null&&r(e,["_query","filter"],a),n}function da(o,t){const e={},n=s(t,["config"]);return n!=null&&r(e,["config"],ca(o,n,e)),e}function fa(o,t,e){const n={},i=s(t,["gcsUri"]);if(e!==void 0&&i!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],i),s(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function pa(o,t){const e={},n=s(t,["gcsUri"]);return n!=null&&r(e,["validationDatasetUri"],n),e}function ma(o,t,e){const n={},i=s(t,["validationDataset"]);e!==void 0&&i!=null&&r(e,["supervisedTuningSpec"],pa(o,i));const l=s(t,["tunedModelDisplayName"]);e!==void 0&&l!=null&&r(e,["tunedModelDisplayName"],l);const a=s(t,["description"]);e!==void 0&&a!=null&&r(e,["description"],a);const c=s(t,["epochCount"]);e!==void 0&&c!=null&&r(e,["supervisedTuningSpec","hyperParameters","epochCount"],c);const d=s(t,["learningRateMultiplier"]);e!==void 0&&d!=null&&r(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],d);const u=s(t,["exportLastCheckpointOnly"]);e!==void 0&&u!=null&&r(e,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const f=s(t,["adapterSize"]);if(e!==void 0&&f!=null&&r(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),s(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(s(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function ha(o,t){const e={},n=s(t,["baseModel"]);n!=null&&r(e,["baseModel"],n);const i=s(t,["trainingDataset"]);i!=null&&r(e,["supervisedTuningSpec","trainingDatasetUri"],fa(o,i,e));const l=s(t,["config"]);return l!=null&&r(e,["config"],ma(o,l,e)),e}function ga(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["model"],n);const i=s(t,["name"]);return i!=null&&r(e,["endpoint"],i),e}function Dn(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["state"]);i!=null&&r(e,["state"],_n(o,i));const l=s(t,["createTime"]);l!=null&&r(e,["createTime"],l);const a=s(t,["tuningTask","startTime"]);a!=null&&r(e,["startTime"],a);const c=s(t,["tuningTask","completeTime"]);c!=null&&r(e,["endTime"],c);const d=s(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const u=s(t,["description"]);u!=null&&r(e,["description"],u);const f=s(t,["baseModel"]);f!=null&&r(e,["baseModel"],f);const p=s(t,["_self"]);p!=null&&r(e,["tunedModel"],ga(o,p));const m=s(t,["distillationSpec"]);m!=null&&r(e,["distillationSpec"],m);const h=s(t,["experiment"]);h!=null&&r(e,["experiment"],h);const g=s(t,["labels"]);g!=null&&r(e,["labels"],g);const y=s(t,["pipelineJob"]);y!=null&&r(e,["pipelineJob"],y);const C=s(t,["tunedModelDisplayName"]);return C!=null&&r(e,["tunedModelDisplayName"],C),e}function ya(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["tunedModels"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>Dn(o,a))),r(e,["tuningJobs"],l)}return e}function Ca(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["metadata"]);i!=null&&r(e,["metadata"],i);const l=s(t,["done"]);l!=null&&r(e,["done"],l);const a=s(t,["error"]);return a!=null&&r(e,["error"],a),e}function Ta(o,t){const e={},n=s(t,["checkpointId"]);n!=null&&r(e,["checkpointId"],n);const i=s(t,["epoch"]);i!=null&&r(e,["epoch"],i);const l=s(t,["step"]);l!=null&&r(e,["step"],l);const a=s(t,["endpoint"]);return a!=null&&r(e,["endpoint"],a),e}function va(o,t){const e={},n=s(t,["model"]);n!=null&&r(e,["model"],n);const i=s(t,["endpoint"]);i!=null&&r(e,["endpoint"],i);const l=s(t,["checkpoints"]);if(l!=null){let a=l;Array.isArray(a)&&(a=a.map(c=>Ta(o,c))),r(e,["checkpoints"],a)}return e}function Je(o,t){const e={},n=s(t,["name"]);n!=null&&r(e,["name"],n);const i=s(t,["state"]);i!=null&&r(e,["state"],_n(o,i));const l=s(t,["createTime"]);l!=null&&r(e,["createTime"],l);const a=s(t,["startTime"]);a!=null&&r(e,["startTime"],a);const c=s(t,["endTime"]);c!=null&&r(e,["endTime"],c);const d=s(t,["updateTime"]);d!=null&&r(e,["updateTime"],d);const u=s(t,["error"]);u!=null&&r(e,["error"],u);const f=s(t,["description"]);f!=null&&r(e,["description"],f);const p=s(t,["baseModel"]);p!=null&&r(e,["baseModel"],p);const m=s(t,["tunedModel"]);m!=null&&r(e,["tunedModel"],va(o,m));const h=s(t,["supervisedTuningSpec"]);h!=null&&r(e,["supervisedTuningSpec"],h);const g=s(t,["tuningDataStats"]);g!=null&&r(e,["tuningDataStats"],g);const y=s(t,["encryptionSpec"]);y!=null&&r(e,["encryptionSpec"],y);const C=s(t,["partnerModelTuningSpec"]);C!=null&&r(e,["partnerModelTuningSpec"],C);const E=s(t,["distillationSpec"]);E!=null&&r(e,["distillationSpec"],E);const _=s(t,["experiment"]);_!=null&&r(e,["experiment"],_);const I=s(t,["labels"]);I!=null&&r(e,["labels"],I);const v=s(t,["pipelineJob"]);v!=null&&r(e,["pipelineJob"],v);const M=s(t,["tunedModelDisplayName"]);return M!=null&&r(e,["tunedModelDisplayName"],M),e}function Ea(o,t){const e={},n=s(t,["nextPageToken"]);n!=null&&r(e,["nextPageToken"],n);const i=s(t,["tuningJobs"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(a=>Je(o,a))),r(e,["tuningJobs"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _a extends ne{constructor(t){super(),this.apiClient=t,this.get=async e=>await this.getInternal(e),this.list=async(e={})=>new Ee(X.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(e),e),this.tune=async e=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(e);{const n=await this.tuneMldevInternal(e);let i="";return n.metadata!==void 0&&n.metadata.tunedModel!==void 0?i=n.metadata.tunedModel:n.name!==void 0&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]),{name:i,state:Fe.JOB_STATE_QUEUED}}}}async getInternal(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=ua(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>Je(this.apiClient,f))}else{const u=na(this.apiClient,t);return c=T("{name}",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>Dn(this.apiClient,f))}}async listInternal(t){var e,n,i,l;let a,c="",d={};if(this.apiClient.isVertexAI()){const u=da(this.apiClient,t);return c=T("tuningJobs",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(f=>f.json()),a.then(f=>{const p=Ea(this.apiClient,f),m=new qt;return Object.assign(m,p),m})}else{const u=ia(this.apiClient,t);return c=T("tunedModels",u._url),d=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(l=t.config)===null||l===void 0?void 0:l.abortSignal}).then(f=>f.json()),a.then(f=>{const p=ya(this.apiClient,f),m=new qt;return Object.assign(m,p),m})}}async tuneInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const c=ha(this.apiClient,t);return l=T("tuningJobs",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>Je(this.apiClient,d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=aa(this.apiClient,t);return l=T("tunedModels",c._url),a=c._query,delete c.config,delete c._url,delete c._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions,abortSignal:(n=t.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>Ca(this.apiClient,d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ia{async download(t,e){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Sa=1024*1024*8,Aa=3,Ma=1e3,Pa=2,Ae="x-goog-upload-status";async function xa(o,t,e){var n,i,l;let a=0,c=0,d=new Ge(new Response),u="upload";for(a=o.size;c<a;){const p=Math.min(Sa,a-c),m=o.slice(c,c+p);c+p>=a&&(u+=", finalize");let h=0,g=Ma;for(;h<Aa&&(d=await e.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(c),"Content-Length":String(p)}}}),!(!((n=d==null?void 0:d.headers)===null||n===void 0)&&n[Ae]));)h++,await wa(g),g=g*Pa;if(c+=p,((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[Ae])!=="active")break;if(a<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const f=await(d==null?void 0:d.json());if(((l=d==null?void 0:d.headers)===null||l===void 0?void 0:l[Ae])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return f.file}async function Ra(o){return{size:o.size,type:o.type}}function wa(o){return new Promise(t=>setTimeout(t,o))}class Da{async upload(t,e,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await xa(t,e,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Ra(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Na{create(t,e,n){return new La(t,e,n)}}class La{constructor(t,e,n){this.url=t,this.headers=e,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const en="x-goog-api-key";class Va{constructor(t){this.apiKey=t}async addAuthHeaders(t){t.get(en)===null&&t.append(en,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ka="gl-node/";class Ua{constructor(t){var e;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=t.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=t.apiKey;const n=Jn(t,void 0,void 0);n&&(t.httpOptions?t.httpOptions.baseUrl=n:t.httpOptions={baseUrl:n}),this.apiVersion=t.apiVersion;const i=new Va(this.apiKey);this.apiClient=new ta({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:ka+"web",uploader:new Da,downloader:new Ia}),this.models=new kl(this.apiClient),this.live=new wl(this.apiClient,i,new Na),this.chats=new Zo(this.models,this.apiClient),this.caches=new Xo(this.apiClient),this.files=new di(this.apiClient),this.operations=new Kl(this.apiClient),this.tunings=new _a(this.apiClient)}}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
 */const Fa=[{name:"Xe Đạp Điện Theli Aima",description:"Thiết kế thời trang, động cơ mạnh mẽ, phù hợp cho việc đi lại trong thành phố.",price:"15.500.000đ",link:"https://example.com/theli-aima",image:"https://i.ibb.co/L5Bwz8M/e-bike-1.jpg",type:"Xe đạp điện",status:"Còn hàng",description_detail:"Xe Đạp Điện Theli Aima là sự kết hợp hoàn hảo giữa phong cách và hiệu suất. Với pin Lithium dung lượng cao, xe có thể đi được quãng đường lên đến 70km mỗi lần sạc. Động cơ 350W mạnh mẽ giúp bạn dễ dàng vượt qua các con dốc. Hệ thống phanh đĩa an toàn, đèn LED siêu sáng.",button_text:"Xem ngay"},{name:"Xe Máy Điện Vinfast Evo200",description:"Quãng đường di chuyển vượt trội, công nghệ pin LFP tiên tiến, chống nước IP67.",price:"22.000.000đ",link:"https://example.com/vinfast-evo200",image:"https://i.ibb.co/h9yVzZk/e-scooter-1.jpg",type:"Xe máy điện",status:"Còn hàng",description_detail:"Vinfast Evo200 thiết lập tiêu chuẩn mới cho xe máy điện với khả năng di chuyển lên tới 200km sau một lần sạc đầy. Động cơ in-hub và công nghệ pin LFP đảm bảo độ bền và an toàn. Xe có khả năng chống nước chuẩn IP67, yên tâm di chuyển trong mọi điều kiện thời tiết.",button_text:"Khám phá"},{name:"Xe Đạp Gấp G-Force C14",description:"Gọn nhẹ, dễ dàng gấp gọn trong 3 bước, phù hợp cho người hay di chuyển.",price:"8.900.000đ",link:"https://example.com/g-force-c14",image:"https://i.ibb.co/D9pXG2N/folding-bike-1.jpg",type:"Xe đạp gấp",status:"Đặt trước",description_detail:"G-Force C14 là giải pháp di chuyển linh hoạt cho đô thị. Với khung hợp kim nhôm siêu nhẹ, chiếc xe có thể được gấp gọn nhanh chóng để mang lên xe bus, tàu điện hoặc cất trong cốp ô tô. Dù nhỏ gọn, xe vẫn được trang bị bộ đề 7 tốc độ và phanh đĩa an toàn.",button_text:"Đặt hàng"},{name:"Pin Lithium 48V-20Ah",description:"Pin thay thế cao cấp cho xe điện, tăng quãng đường, tuổi thọ cao.",price:"4.200.000đ",link:"https://example.com/pin-lithium",image:"https://i.ibb.co/qYn0S2G/battery-1.jpg",type:"Linh kiện",status:"Còn hàng",description_detail:"Nâng cấp cho xe điện của bạn với pin Lithium 48V-20Ah. Pin sử dụng cell chất lượng cao, cho dòng xả ổn định và tuổi thọ lên đến 5 năm. Vỏ nhôm chống va đập, tích hợp mạch quản lý pin (BMS) thông minh để bảo vệ chống sạc quá mức, xả quá sâu và ngắn mạch.",button_text:"Xem chi tiết"},{name:"Xe Máy Điện Yadea G5",description:"Thiết kế tối giản đậm chất châu Âu, động cơ GTR 2.0 độc quyền.",price:"39.990.000đ",link:"https://example.com/yadea-g5",image:"https://i.ibb.co/wJ2cR6J/e-scooter-2.jpg",type:"Xe máy điện",status:"Hết hàng",description_detail:"Yadea G5 mang vẻ đẹp hiện đại, tinh tế. Xe được trang bị màn hình LCD 7 inch, hệ thống khóa thông minh và động cơ GTR 2.0 mạnh mẽ, tiết kiệm năng lượng. Khung xe bằng thép cán lạnh cao cấp, đảm bảo độ vững chắc và an toàn tối đa.",button_text:"Xem chi tiết"}],Ga=[{title:"5 Lợi Ích Của Việc Sử Dụng Xe Đạp Điện",description:"Khám phá những lợi ích không ngờ về sức khỏe, tài chính và môi trường khi bạn chuyển sang sử dụng xe đạp điện hàng ngày.",link:"https://example.com/blog/loi-ich-xe-dap-dien",imageURL:"https://i.ibb.co/MfZg7fG/blog-1.jpg"},{title:"Hướng Dẫn Bảo Dưỡng Pin Xe Máy Điện Đúng Cách",description:"Pin là trái tim của xe điện. Tìm hiểu các mẹo bảo dưỡng đơn giản để kéo dài tuổi thọ pin và đảm bảo hiệu suất tối ưu.",link:"https://example.com/blog/bao-duong-pin",imageURL:"https://i.ibb.co/tZ5tF7X/blog-2.jpg"},{title:"Xe Đạp Gấp: Giải Pháp Di Chuyển Thông Minh Cho Đô Thị",description:"Tại sao xe đạp gấp lại trở thành xu hướng? Chúng ta sẽ phân tích sự tiện lợi và linh hoạt mà chúng mang lại cho cuộc sống thành thị.",link:"https://example.com/blog/xu-huong-xe-dap-gap",imageURL:"https://i.ibb.co/r2kQZ7x/blog-3.jpg"}],qa=[{product_type:"Xe đạp điện",author:"Minh Anh",text:"Xe Theli Aima đi êm thật, thiết kế đẹp, bạn bè ai cũng khen. Sạc cũng nhanh đầy nữa.",date:"20/05/2024"},{product_type:"Xe máy điện",author:"Tuấn Khải",text:"Mua Vinfast Evo200 không hối hận. Đi làm cả tuần mới phải sạc một lần, quá tiện. Xe đi đầm và chắc chắn.",date:"18/05/2024"},{product_type:"Xe đạp gấp",author:"Phương Linh",text:"Mình rất thích chiếc G-Force C14. Mỗi cuối tuần mình đều bỏ nó vào cốp xe đi dã ngoại. Gấp mở rất dễ dàng.",date:"15/05/2024"},{product_type:"Linh kiện",author:"Bảo Nam",text:"Pin Lithium 48V-20Ah này tốt hơn hẳn ắc quy cũ của mình. Xe chạy bốc hơn và đi được xa hơn nhiều.",date:"12/05/2024"},{product_type:"Xe máy điện",author:"An Nhiên",text:"Tiếc là Yadea G5 đang hết hàng, mình rất thích mẫu này. Hi vọng shop sớm nhập hàng về lại.",date:"10/05/2024"},{product_type:"Xe đạp điện",author:"Quốc Trung",text:"Tìm mãi mới được một chiếc xe đạp điện ưng ý. Nhân viên tư vấn nhiệt tình, sẽ giới thiệu bạn bè.",date:"05/05/2024"}],Nn="thegioixedien_recent_searches",tn=5,Ln="thegioixedien_recently_viewed",nn=5,he="thegioixedien_product_clicks",Ba="thegioixedien_managed_products";let S=[],Vn=[],ge=null;const Ha="Tienoi.one - Khám phá Sản phẩm & Dịch vụ";let L=1;const R=document.getElementById("results"),U=document.getElementById("loading-spinner"),W=document.getElementById("blog-grid"),Me=document.getElementById("recently-viewed-section"),Pe=document.getElementById("recently-viewed-container"),xe=document.getElementById("contact-form"),re=document.getElementById("nav-toggle"),le=document.getElementById("nav-menu"),on=document.getElementById("search-form"),ye=document.getElementById("search-input"),Q=document.getElementById("suggestions-container"),Re=document.getElementById("recent-searches-section"),we=document.getElementById("recent-searches-container"),x=document.getElementById("product-modal"),sn=document.getElementById("modal-close-button"),rn=document.getElementById("modal-product-name"),De=document.getElementById("modal-product-image"),ln=document.getElementById("modal-product-price"),an=document.getElementById("modal-product-description"),Ne=document.getElementById("modal-product-link"),ae=document.getElementById("modal-product-type"),Y=document.getElementById("modal-product-status"),K=document.getElementById("modal-product-rating-stars"),un=document.getElementById("share-facebook"),cn=document.getElementById("share-zalo"),dn=document.getElementById("share-linkedin"),fn=document.getElementById("share-threads"),Z=document.getElementById("admin-product-list-container"),pn=document.getElementById("add-new-product-btn"),F=document.getElementById("admin-form-modal"),mn=document.getElementById("admin-modal-close-button"),Ce=document.getElementById("admin-product-form"),Le=document.getElementById("admin-form-title"),j=document.getElementById("admin-form-product-name-original");function ee(o){document.title=o||Ha}function $a(o){const t=[...o];for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}if(re&&le){const o=le.querySelectorAll("a"),t=()=>{const e=le.classList.toggle("is-active");re.classList.toggle("is-active"),re.setAttribute("aria-expanded",String(e)),document.body.classList.toggle("no-scroll",e)};re.addEventListener("click",t),o.forEach(e=>{e.addEventListener("click",n=>{n.preventDefault();const i=e.getAttribute("href");i&&i===window.location.hash?Ye():i&&(window.location.hash=i),le.classList.contains("is-active")&&t()})})}function ba(){const o=document.querySelector(".nav-container");if(!o)return;let t=0;const e=50,n=i=>{const l=i-t;Math.abs(l)>e&&o.classList.toggle("is-rounded")};o.addEventListener("touchstart",i=>{t=i.changedTouches[0].clientX},{passive:!0}),o.addEventListener("touchend",i=>{const l=i.changedTouches[0].clientX;n(l)}),o.addEventListener("mousedown",i=>{t=i.clientX}),o.addEventListener("mouseup",i=>{const l=i.clientX;n(l)})}function kn(){const o=localStorage.getItem(Nn);return o?JSON.parse(o):[]}function Ja(o){if(!o)return;let t=kn();t=t.filter(e=>e.toLowerCase()!==o.toLowerCase()),t.unshift(o),t.length>tn&&(t=t.slice(0,tn)),localStorage.setItem(Nn,JSON.stringify(t))}function Un(){if(!we||!Re)return;const o=kn();if(o.length===0){Re.style.display="none";return}we.innerHTML="",o.forEach(t=>{const e=document.createElement("button");e.className="recent-search-tag",e.textContent=t,e.type="button",e.addEventListener("click",()=>{te(t)}),we.appendChild(e)}),Re.style.display="block"}function Fn(){const o=localStorage.getItem(Ln);return o?JSON.parse(o):[]}function Ya(o){if(!o||!o.name)return;let t=Fn();t=t.filter(e=>e.name!==o.name),t.unshift(o),t.length>nn&&(t=t.slice(0,nn)),localStorage.setItem(Ln,JSON.stringify(t))}function Gn(){if(!Me||!Pe)return;const o=Fn();if(o.length===0){Me.style.display="none";return}Pe.innerHTML="",o.forEach(t=>{const e=za(t);Pe.appendChild(e)}),Me.style.display="block"}function Ie(o){try{const t=localStorage.getItem(he);return(t?JSON.parse(t):{})[o]||0}catch(t){return console.warn("Could not read product clicks from localStorage.",t),0}}function Ka(o){try{const t=localStorage.getItem(he),e=t?JSON.parse(t):{},n=(e[o]||0)+1;e[o]=n,localStorage.setItem(he,JSON.stringify(e))}catch(t){console.warn("Could not save product clicks to localStorage.",t)}}function Wa(o){const t=document.querySelector(`.product-card[data-product-name="${o}"]`);if(!t)return;const e=t.querySelector(".product-stats");if(!e)return;const n=Ie(o),i=n>=10?'<div class="product-rating">★★★★★</div>':"",a=`<div class="product-clicks"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/><path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/></svg> <span>${n}</span></div>`;e.innerHTML=i+a}function Xa(o){var m,h,g;if(!x||!rn||!De||!ln||!an||!Ne||!ae||!Y||!K||!un||!cn||!dn||!fn)return;ge=o,ee(`${o.name} | Tienoi.one`);const t=x.querySelectorAll(".modal-tab-button"),e=x.querySelectorAll(".modal-tab-panel");t.forEach(y=>y.classList.remove("is-active")),e.forEach(y=>y.classList.remove("is-active")),(m=x.querySelector('.modal-tab-button[data-tab-target="#tab-panel-details"]'))==null||m.classList.add("is-active"),(h=x.querySelector("#tab-panel-details"))==null||h.classList.add("is-active"),rn.textContent=o.name,De.src=o.image,De.alt=o.name,ln.textContent=o.price,an.textContent=o.description_detail||o.description,Ne.href=o.link,Ne.textContent=o.button_text||"Xem chi tiết",o.type?(ae.textContent=o.type,ae.style.display="inline-block"):ae.style.display="none",o.status?(Y.textContent=o.status,Y.dataset.status=o.status.toLowerCase().replace(/\s+/g,"-"),Y.style.display="inline-block"):(Y.style.display="none",Y.textContent="",delete Y.dataset.status),Ie(o.name)>=10?(K.innerHTML="★★★★★",K.setAttribute("aria-label","5 out of 5 stars"),K.style.display="block"):(K.innerHTML="",K.style.display="none");const i=encodeURIComponent(o.link),l=encodeURIComponent(`Khám phá sản phẩm này: ${o.name}`);un.href=`https://www.facebook.com/sharer/sharer.php?u=${i}`,cn.href=`https://sp.zalo.me/share_inline?url=${i}&type=1`,dn.href=`https://www.linkedin.com/sharing/share-offsite/?url=${i}`,fn.href=`https://www.threads.net/share?url=${i}&text=${l}`;const a=document.querySelector("#tab-panel-consultant .consultant-initial-message"),c=document.getElementById("consultant-result-container");a&&(a.style.display="block"),c&&(c.innerHTML="");const d=document.getElementById("comments-list"),u=document.getElementById("comments-pagination");if(d&&u){const y=o.type?o.type.trim().toLowerCase():"",C=o.name.trim().toLowerCase().split(/\s+/),E=Vn.filter(V=>{if(!(V.product_type&&V.product_type.trim().toLowerCase()===y))return!1;const k=(V.text||"").toLowerCase();return C.length===0||C[0]===""?!1:C.some(B=>k.includes(B))}),_=$a(E),I=5,v=Math.ceil(_.length/I),M=V=>{if(d.innerHTML="",u.innerHTML="",_.length===0){d.innerHTML='<p class="no-comments-message">Chưa có nhận xét nào phù hợp cho sản phẩm này.</p>';return}const G=Math.max(1,Math.min(V,v)),k=(G-1)*I;if(_.slice(k,k+I).forEach(P=>{const w=Qa(P);d.appendChild(w)}),v>1)for(let P=1;P<=v;P++){const w=document.createElement("button");w.className="pagination-button",w.textContent=String(P),w.setAttribute("aria-label",`Go to page ${P}`),P===G&&(w.classList.add("is-active"),w.setAttribute("aria-current","page")),w.addEventListener("click",()=>M(P)),u.appendChild(w)}};M(1)}const f=document.getElementById("modal-related-container"),p=x.querySelector(".modal-related-products");if(f&&p){f.innerHTML="";const y=S.filter(C=>C.type===o.type&&C.name!==o.name).slice(0,4);y.length>0?(y.forEach(C=>{const E=Oa(C);f.appendChild(E)}),p.style.display="block"):p.style.display="none"}x.classList.add("is-visible"),document.body.classList.add("no-scroll"),(g=x.querySelector(".modal-body"))==null||g.scrollTo(0,0)}function Ve(){x&&(x.classList.remove("is-visible"),document.body.classList.remove("no-scroll"),ge=null,ee())}function qn(o){const t=document.createElement("div");t.className="product-card",t.dataset.productName=o.name;const e=Ie(o.name),n=e>=10?'<div class="product-rating" aria-label="5 out of 5 stars">★★★★★</div>':"",l=`<div class="product-clicks" aria-label="${e} views"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/><path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/></svg> <span>${e}</span></div>`,a={"@context":"https://schema.org","@type":"Product",name:o.name,image:o.image,description:o.description,url:o.link,offers:{"@type":"Offer",priceCurrency:"VND",price:o.price.replace(/[^0-9]/g,""),availability:o.status.toLowerCase().includes("hết hàng")?"https://schema.org/OutOfStock":"https://schema.org/InStock",url:o.link},...e>=10&&{aggregateRating:{"@type":"AggregateRating",ratingValue:"5",reviewCount:e.toString()}}},c=`<script type="application/ld+json">${JSON.stringify(a)}<\/script>`;return t.innerHTML=`
    ${c}
    <div class="product-image-container">
      <img src="${o.image}" alt="${o.name}" class="product-image" loading="lazy">
      ${o.type?`<span class="product-type">${o.type}</span>`:""}
      ${o.status?`<span class="product-status" data-status="${o.status.toLowerCase().replace(/\s+/g,"-")}">${o.status}</span>`:""}
    </div>
    <div class="product-content">
      <h3>${o.name}</h3>
      <p>${o.description}</p>
      <div class="product-footer">
        <div class="product-meta">
            <div class="product-price">${o.price}</div>
            <div class="product-stats">
                ${n}
                ${l}
            </div>
        </div>
        <a href="${o.link}" target="_blank" rel="noopener noreferrer" class="product-link">Xem chi tiết</a>
      </div>
    </div>
  `,t}function za(o){const t=document.createElement("div");return t.className="recent-product-card",t.dataset.productName=o.name,t.setAttribute("role","button"),t.tabIndex=0,t.innerHTML=`
        <img src="${o.image}" alt="${o.name}" class="recent-product-logo">
        <span class="recent-product-name">${o.name}</span>
    `,t}function Oa(o){const t=document.createElement("div");return t.className="related-product-card",t.dataset.productName=o.name,t.setAttribute("role","button"),t.tabIndex=0,t.innerHTML=`
        <img src="${o.image}" alt="${o.name}" loading="lazy">
        <div class="related-product-details">
            <div class="related-product-name">${o.name}</div>
            <div class="related-product-price">${o.price}</div>
        </div>
    `,t}function Qa(o){const t=document.createElement("div");t.className="comment-card";const e=o.author?o.author.substring(0,1).toUpperCase():"?";return t.innerHTML=`
        <div class="comment-avatar" aria-hidden="true">${e}</div>
        <div class="comment-content">
            <div class="comment-header">
                <span class="comment-author">${o.author||"Anonymous"}</span>
                ${o.date?`<span class="comment-date">${o.date}</span>`:""}
            </div>
            <p class="comment-text">${o.text||""}</p>
        </div>
    `,t}function ke(o,t=""){if(!R)return;if(R.innerHTML=t,!o||o.length===0){t||(R.innerHTML+='<p class="initial-message">Không tìm thấy sản phẩm nào phù hợp với tìm kiếm của bạn.</p>');return}const e=document.createElement("div");e.className="product-grid-inner";for(const n of o){const i=qn(n);e.appendChild(i)}R.appendChild(e)}function z(o){if(!R||!o||o.length===0)return;const t=localStorage.getItem(he),e=t?JSON.parse(t):{},n=o.map(p=>({...p,clicks:e[p.name]||0}));n.sort((p,m)=>m.clicks-p.clicks);const i=n.slice(0,12),a=window.innerWidth<769?4:6,c=i.length>a;R.innerHTML="<h2>Sản phẩm nổi bật</h2>";let d=i,u=1;if(c){u=Math.ceil(i.length/a),L=Math.max(1,Math.min(L,u));const p=(L-1)*a;d=i.slice(p,p+a)}const f=document.createElement("div");if(f.className="product-grid-inner",d.forEach(p=>{f.appendChild(qn(p))}),R.appendChild(f),c){const p=document.createElement("div");p.className="featured-pagination-container";const m=document.createElement("button");m.textContent="Trước",m.className="pagination-button",m.disabled=L===1,m.addEventListener("click",()=>{L>1&&(L--,z(S),R.scrollIntoView({behavior:"smooth",block:"start"}))});const h=document.createElement("span");h.className="pagination-info",h.textContent=`Trang ${L} / ${u}`;const g=document.createElement("button");g.textContent="Sau",g.className="pagination-button",g.disabled=L===u,g.addEventListener("click",()=>{L<u&&(L++,z(S),R.scrollIntoView({behavior:"smooth",block:"start"}))}),p.appendChild(m),p.appendChild(h),p.appendChild(g),R.appendChild(p)}}function Za(o){return S.filter(t=>t.type===o).reduce((t,e)=>t+Ie(e.name),0)}function Xe(o){if(!Q)return;const t=[...new Set(o.map(e=>e.type).filter(e=>e&&e.trim()!==""))].map(e=>({type:e,score:Za(e)})).sort((e,n)=>n.score-e.score);Q.innerHTML="",t.forEach(({type:e,score:n})=>{const i=document.createElement("div");i.className="smart-suggestion-item",i.setAttribute("role","button"),i.tabIndex=0,i.dataset.query=e;const l=Math.round(n*1.6),a=n>0?`<span class="trend-score">${l.toLocaleString()}</span>`:"";i.innerHTML=`
            <span class="suggestion-text">${e}</span>
            <div class="suggestion-trend">
                ${a}
                <div class="trend-icon" aria-label="Trending">
                    <svg viewBox="0 0 24 10" preserveAspectRatio="none">
                        <polyline points="0 8, 4 4, 8 6, 12 2, 16 5, 20 3, 24 6" />
                    </svg>
                </div>
            </div>
        `,Q.appendChild(i)})}function ja(o){if(!W)return;const t=document.getElementById("loading-spinner-blog");if(t&&(t.style.display="none"),!o||o.length===0){W.innerHTML='<p class="initial-message">Hiện chưa có bài viết nào.</p>';return}W.innerHTML="";for(const e of o){const n=document.createElement("div");n.className="article-card",n.innerHTML=`
      <img src="${e.imageURL}" alt="${e.title}" class="article-image" loading="lazy">
      <div class="article-content">
        <h3>${e.title}</h3>
        <p>${e.description}</p>
        <a href="${e.link}" target="_blank" rel="noopener noreferrer" class="article-link">Đọc thêm</a>
      </div>
    `,W.appendChild(n)}}async function eu(o){try{const n=(await new Ua({apiKey:void 0}).models.generateContent({model:"gemini-2.5-flash",contents:`Act as an impartial expert product consultant. Based on the following product information, provide a concise analysis in Vietnamese for a potential customer.
            Product Name: ${o.name}
            Product Price: ${o.price}
            Product Description: ${o.description_detail||o.description}

            Your analysis should highlight key advantages, points to consider (including an evaluation of the price in relation to the described features and benefits), and a final summary about its overall value.
            `,config:{responseMimeType:"application/json",responseSchema:{type:H.OBJECT,properties:{advantages:{type:H.ARRAY,description:"Key advantages of the product, in Vietnamese.",items:{type:H.STRING}},considerations:{type:H.ARRAY,description:"Points for the customer to consider, or potential drawbacks, in Vietnamese. This should include a comment on the price vs. value.",items:{type:H.STRING}},summary:{type:H.STRING,description:"A final summary and recommendation about the product's overall value, in Vietnamese."}},required:["advantages","considerations","summary"]}}})).text.trim(),i=JSON.parse(n);return tu(i)}catch(t){return console.error("Gemini API call for advice failed:",t),'<p class="initial-message">Rất tiếc, tính năng tư vấn chuyên gia đang tạm thời gián đoạn. Vui lòng thử lại sau.</p>'}}function tu(o){const t=o.advantages.length>0?`<ul>${o.advantages.map(n=>`<li>${n}</li>`).join("")}</ul>`:"<p>Không có ưu điểm đặc biệt nào được ghi nhận.</p>",e=o.considerations.length>0?`<ul>${o.considerations.map(n=>`<li>${n}</li>`).join("")}</ul>`:"<p>Không có điểm cần cân nhắc đặc biệt.</p>";return`
        <h4>Ưu điểm nổi bật</h4>
        ${t}
        <h4>Điểm cần cân nhắc</h4>
        ${e}
        <h4>Kết luận của chuyên gia</h4>
        <p class="summary">${o.summary}</p>
    `}function te(o){o&&(ye&&(ye.value=o),nu(o),R==null||R.scrollIntoView({behavior:"smooth"}))}function nu(o){const t=o.trim(),e=new URL(window.location.href);t?(e.searchParams.set("q",t),ee(`Tìm kiếm '${t}' | Tienoi.one`)):(e.searchParams.delete("q"),ee());try{const l=e.pathname+e.search;window.history.pushState({query:t},"",l)}catch(l){console.warn("Could not update URL history.",l)}if(U&&(U.style.display="block"),R&&(R.innerHTML=""),!t){U&&(U.style.display="none"),L=1,z(S);return}Ja(t),Un();const n=t.toLowerCase();let i=S.filter(l=>(l.type?l.type.toLowerCase().trim():"")===n);if(i.length>0)ke(i,`<h2>Kết quả cho loại sản phẩm: ${t}</h2>`);else if(i=S.filter(l=>l.name.toLowerCase().includes(n)),i.length>0){const l=`<p class="search-assist-message">Không tìm thấy kết quả chính xác cho loại sản phẩm. Hiển thị kết quả chứa <strong>"${t}"</strong> trong tên:</p>`;ke(i,l)}else ke([],'<h2>Không tìm thấy sản phẩm nào</h2><p class="initial-message">Rất tiếc, không có sản phẩm nào phù hợp với tìm kiếm của bạn. Hãy thử một trong các gợi ý phổ biến bên dưới.</p>');U&&(U.style.display="none")}function ou(){if(!U||!R||!W){console.error("Essential DOM elements are missing. App cannot initialize.");return}ee(),Un(),Gn(),U.style.display="block",R.innerHTML="";const o=document.getElementById("loading-spinner-blog");o&&(o.style.display="block");try{S=Fa,Vn=qa;const t=Ga;Xe(S),ja(t),su(t,S);const n=new URLSearchParams(window.location.search).get("q");n?te(n):(L=1,z(S))}catch(t){console.error("Error during app initialization:",t),R.innerHTML='<h2>Đã có lỗi xảy ra</h2><p class="initial-message">Không thể tải dữ liệu sản phẩm. Vui lòng thử lại sau.</p>',W.innerHTML='<p class="initial-message">Không thể tải các bài viết. Vui lòng thử lại sau.</p>'}finally{U&&(U.style.display="none"),o&&(o.style.display="none")}}function iu(){const o=document.getElementById("particle-canvas");if(!o)return;const t=o.getContext("2d");let e=[];const n=o.parentElement,i=()=>{o.width=n.offsetWidth,o.height=n.offsetHeight};i();class l{constructor(p,m,h,g,y){this.x=p,this.y=m,this.directionX=h,this.directionY=g,this.size=y}draw(){t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2,!1),t.fillStyle="rgba(0, 191, 255, 0.5)",t.fill()}update(){(this.x>o.width||this.x<0)&&(this.directionX=-this.directionX),(this.y>o.height||this.y<0)&&(this.directionY=-this.directionY),this.x+=this.directionX,this.y+=this.directionY,this.draw()}}function a(){e=[];let f=o.height*o.width/12e3;for(let p=0;p<f;p++){let m=Math.random()*2+1,h=Math.random()*(o.width-m*2-m*2)+m*2,g=Math.random()*(o.height-m*2-m*2)+m*2,y=Math.random()*.4-.2,C=Math.random()*.4-.2;e.push(new l(h,g,y,C,m))}}function c(){let f=1;for(let p=0;p<e.length;p++)for(let m=p;m<e.length;m++){let h=(e[p].x-e[m].x)*(e[p].x-e[m].x)+(e[p].y-e[m].y)*(e[p].y-e[m].y);h<o.width/7*(o.height/7)&&(f=1-h/2e4,t.strokeStyle=`rgba(0, 191, 255, ${f})`,t.lineWidth=1,t.beginPath(),t.moveTo(e[p].x,e[p].y),t.lineTo(e[m].x,e[m].y),t.stroke())}}function d(){requestAnimationFrame(d),t.clearRect(0,0,o.width,o.height);for(let f=0;f<e.length;f++)e[f].update();c()}new ResizeObserver(()=>{i(),a()}).observe(n),a(),d()}function su(o,t){const e=document.getElementById("footer-tags-container");e&&t&&(e.innerHTML="",[...new Set(t.map(l=>l.type).filter(Boolean))].slice(0,8).forEach(l=>{const a=document.createElement("a");a.href="#",a.className="footer-tag",a.textContent=l,a.addEventListener("click",c=>{c.preventDefault(),l&&te(l)}),e.appendChild(a)}));const n=document.getElementById("footer-blog-container");n&&(n.innerHTML="",o.slice(0,4).forEach(i=>{const l=document.createElement("li"),a=document.createElement("a");a.href=i.link,a.textContent=i.title,a.target="_blank",a.rel="noopener noreferrer",l.appendChild(a),n.appendChild(l)}))}function Bn(){try{localStorage.setItem(Ba,JSON.stringify(S))}catch(o){console.error("Failed to save products to localStorage.",o),alert("Lỗi: Không thể lưu sản phẩm. Bộ nhớ của trình duyệt có thể đã đầy.")}}function ze(){if(!Z)return;const o=S;if(o.length===0){Z.innerHTML='<p class="initial-message">Chưa có sản phẩm nào. Hãy thêm một sản phẩm!</p>';return}const t=`
        <table class="admin-product-table">
            <thead>
                <tr>
                    <th>Hình ảnh</th>
                    <th>Tên sản phẩm</th>
                    <th>Loại</th>
                    <th>Giá</th>
                    <th>Hành động</th>
                </tr>
            </thead>
            <tbody>
                ${o.map(e=>`
                    <tr data-product-name="${e.name}">
                        <td class="product-image-cell"><img src="${e.image}" alt="${e.name}"></td>
                        <td>${e.name}</td>
                        <td>${e.type}</td>
                        <td>${e.price}</td>
                        <td class="product-actions-cell">
                            <button class="action-btn edit" data-product-name="${e.name}">Sửa</button>
                            <button class="action-btn delete" data-product-name="${e.name}">Xóa</button>
                        </td>
                    </tr>
                `).join("")}
            </tbody>
        </table>
    `;Z.innerHTML=t}function hn(o){!F||!Le||!Ce||!j||(Ce.reset(),o?(Le.textContent="Sửa Sản Phẩm",j.value=o.name,document.getElementById("admin-product-name").value=o.name,document.getElementById("admin-product-type").value=o.type,document.getElementById("admin-product-price").value=o.price,document.getElementById("admin-product-status").value=o.status,document.getElementById("admin-product-image").value=o.image,document.getElementById("admin-product-link").value=o.link,document.getElementById("admin-product-description").value=o.description,document.getElementById("admin-product-description-detail").value=o.description_detail,document.getElementById("admin-product-button-text").value=o.button_text):(Le.textContent="Thêm Sản Phẩm Mới",j.value=""),F.classList.add("is-visible"),document.body.classList.add("no-scroll"))}function de(){F&&(F.classList.remove("is-visible"),document.body.classList.remove("no-scroll"))}function ru(o){if(o.preventDefault(),!j)return;const t=j.value,e={name:document.getElementById("admin-product-name").value,type:document.getElementById("admin-product-type").value,price:document.getElementById("admin-product-price").value,status:document.getElementById("admin-product-status").value,image:document.getElementById("admin-product-image").value,link:document.getElementById("admin-product-link").value,description:document.getElementById("admin-product-description").value,description_detail:document.getElementById("admin-product-description-detail").value,button_text:document.getElementById("admin-product-button-text").value};if(t){const n=S.findIndex(i=>i.name===t);n>-1&&(S[n]=e)}else S.unshift(e);Bn(),ze(),Xe(S),z(S),de()}function lu(o){confirm(`Bạn có chắc chắn muốn xóa sản phẩm "${o}" không?`)&&(S=S.filter(t=>t.name!==o),Bn(),ze(),Xe(S),z(S))}const Ye=()=>{const o=window.location.hash||"#home",t=document.querySelector("header"),e=document.querySelector("main"),n=document.querySelector("footer"),i=document.getElementById("privacy-policy-page"),l=document.getElementById("terms-of-service-page"),a=document.getElementById("admin-page"),c=[t,e,n,i,l,a].filter(Boolean),d=o.startsWith("#/");if(c.forEach(u=>u.style.display="none"),d){let u=null;o==="#/privacy-policy"?u=i:o==="#/terms-of-service"?u=l:o==="#/admin"&&(u=a),u?(u.style.display="block",o==="#/admin"&&ze(),window.scrollTo(0,0)):([t,e,n].forEach(f=>f.style.display=""),window.location.hash="#home")}else[t,e,n].forEach(u=>u.style.display=""),setTimeout(()=>{const u=o.length>1?o:"#home";try{const f=document.querySelector(u);f&&f.scrollIntoView({behavior:"smooth",block:"start"})}catch(f){console.warn(`Could not scroll to selector: ${u}`,f),window.scrollTo({top:0,behavior:"smooth"})}},50)};document.addEventListener("DOMContentLoaded",()=>{ba(),iu(),ou();const o=t=>{const e=S.find(n=>n.name===t);e&&(Ka(e.name),Wa(e.name),Ya(e),Gn(),Xa(e))};if(on&&on.addEventListener("submit",t=>{t.preventDefault(),ye&&te(ye.value)}),Q&&Q.addEventListener("click",t=>{const n=t.target.closest(".smart-suggestion-item");if(n){const i=n.dataset.query;i&&te(i)}}),document.body.addEventListener("click",t=>{const e=t.target,n=e.closest(".product-card, .recent-product-card, .related-product-card");if(n!=null&&n.dataset.productName){const i=e.closest("a");i&&i.classList.contains("product-link")&&t.preventDefault(),o(n.dataset.productName)}}),document.addEventListener("keydown",t=>{t.key==="Escape"&&(x!=null&&x.classList.contains("is-visible")&&Ve(),F!=null&&F.classList.contains("is-visible")&&de())}),sn&&sn.addEventListener("click",Ve),x){x.addEventListener("click",n=>{n.target===x&&Ve()}),x.querySelectorAll(".modal-tab-button").forEach(n=>{n.addEventListener("click",()=>{const i=n.getAttribute("data-tab-target");if(!i)return;x.querySelectorAll(".modal-tab-button").forEach(a=>a.classList.remove("is-active")),x.querySelectorAll(".modal-tab-panel").forEach(a=>a.classList.remove("is-active")),n.classList.add("is-active");const l=document.querySelector(i);l==null||l.classList.add("is-active")})});const e=document.getElementById("generate-advice-button");e&&e.addEventListener("click",async()=>{if(!ge)return;const n=document.querySelector("#tab-panel-consultant .consultant-initial-message"),i=document.getElementById("consultant-result-container");if(n&&(n.style.display="none"),i){i.innerHTML='<div class="loading-spinner" style="display: block;"></div>';const l=await eu(ge);i.innerHTML=l}})}xe&&xe.addEventListener("submit",t=>{t.preventDefault();const e=document.getElementById("form-status");e&&(e.textContent="Gửi thành công! Cảm ơn bạn đã liên hệ.",e.style.color="#28a745",xe.reset(),setTimeout(()=>{e.textContent=""},4e3))}),pn&&pn.addEventListener("click",()=>hn()),mn&&mn.addEventListener("click",de),F&&F.addEventListener("click",t=>{t.target===F&&de()}),Ce&&Ce.addEventListener("submit",ru),Z&&Z.addEventListener("click",t=>{const e=t.target,n=e.dataset.productName;if(n)if(e.classList.contains("edit")){const i=S.find(l=>l.name===n);i&&hn(i)}else e.classList.contains("delete")&&lu(n)}),window.addEventListener("hashchange",Ye),Ye()});
